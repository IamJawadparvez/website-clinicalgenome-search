var $jscomp={scope:{},findInternal:function(w,A,x){w instanceof String&&(w=String(w));for(var y=w.length,F=0;F<y;F++){var P=w[F];if(A.call(x,P,F,w))return{i:F,v:P}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(w,A,x){if(x.get||x.set)throw new TypeError("ES3 does not support getters and setters.");w!=Array.prototype&&w!=Object.prototype&&(w[A]=x.value)};
$jscomp.getGlobal=function(w){return"undefined"!=typeof window&&window===w?w:"undefined"!=typeof global&&null!=global?global:w};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(w,A,x,y){if(A){x=$jscomp.global;w=w.split(".");for(y=0;y<w.length-1;y++){var F=w[y];F in x||(x[F]={});x=x[F]}w=w[w.length-1];y=x[w];A=A(y);A!=y&&null!=A&&$jscomp.defineProperty(x,w,{configurable:!0,writable:!0,value:A})}};
$jscomp.polyfill("Array.prototype.find",function(w){return w?w:function(w,x){return $jscomp.findInternal(this,w,x).v}},"es6-impl","es3");$jscomp.polyfill("Array.prototype.fill",function(w){return w?w:function(w,x,y){var A=this.length||0;0>x&&(x=Math.max(0,A+x));if(null==y||y>A)y=A;y=Number(y);0>y&&(y=Math.max(0,A+y));for(x=Number(x||0);x<y;x++)this[x]=w;return this}},"es6-impl","es3");
(function(w){function A(a){return null==a||va.test(a)}function x(a,c){var b,d=this,f=c&&c.embedFont,h={taxid:this.taxid,align:this.getServerAlign(),font:this._fontFace+"|"+this._fontSize+(f?"|1":""),ideowidth:this.ideowidth,ideoheight:this.ideoheight,numrows:this.numrows,numcols:this.numcols,C:this.chroms&&0<this.chroms.length?this.chroms.join(","):void 0,mode:this.orientation,chl:this._chl.position+"|"+this._chl.fontSize+"|"+this._chl.color+"|"+this._chl.align};this.rep&&this.rep.addToRequest(h);
if(f=this.getLegends())h.legend=f.encode();this.bandLabels&&(h.bandlabels=this.bandLabels.encode(this));if(f=this.getShapeList())h.shapes=f.serialize();this._elementOrder&&0<this._elementOrder.length&&(h.order=this._elementOrder.join(","));if(this._colors){var f=[],e;for(e in this._colors)this._colors.hasOwnProperty(e)&&f.push(e+":"+this._colors[e]);h.colors=f.join(",")}this._alts&&(h.alts="on");this._pseudo||(h.pseudo="off");null!=this._dev&&(h.dev=this._dev);this._service&&(h.svc=this._service);
if(c){for(e=0;e<fa.length;e++)f=fa[e],null!=c[f]&&(h[f]=c[f]);c.size&&(IDEO.assert(!isNaN(c.size.width)&&!isNaN(c.size.height)&&0<c.size.width&&0<c.size.height,"size: width and height must be positive numbers"),h.size=String(c.size.width)+"x"+String(c.size.height))}this.setNeedsDisplay(!0);this._loading=!0;(function(){IDEO.Annotation.EncodeAnnotations(h,a);var e={type:"POST",url:d.getIdeoCGI(),data:jQuery.extend({},h),dataType:"json",async:d._isAsync(),success:function(a){delete d._errorInfo;if(c&&
c.onload)c.onload.call(d,a,c);else if(d.onDataLoad)try{y.call(d,a,c),d.onDataLoad.call(d,a,c)}catch(l){console.error(l)}else F.call(d,a,c)},error:function(a,e,g){var m=(Date.now()-b)/1E3;d._errorInfo={status:parseInt(a.status),statusText:a.statusText,tm:m};try{var f="IdeogramFetchError: "+a.status+" "+a.statusText+" (time = "+String(m)+" sec)";IDEO.pingError(f);console.error(f)}catch(n){}if(c&&c.onerror){var h=c.onErrorContext||d.onErrorContext||d;c.onerror.apply(h,arguments)}else if(d.onDataError)try{h=
d.onErrorContext||d,d.onDataError.apply(h,arguments)}catch(n){console.error(n)}else wa.apply(d,arguments)}};d._timeout&&(e.timeout=d._timeout);b=Date.now();jQuery.ajax(e)})()}function y(a,c){IDEO.debugLog("Fetched ideogram data");this.setErrorCode(a.status);if(a.errors&&0<a.errors.length)for(var b=0;b<a.errors.length;b++)this.addRequestError(a.errors[b]);this._chromMap={};this.chroms=[];this._bandMap={};var d={},f={};a.layer?d=this.layers=xa.call(this,a.layer):delete this.layers;for(var h=a.ideo_spec||
[],b=0;b<h.length;b++){var e=h[b];f[e.id]=e}null!=a.rep&&IDEO._updateRep.call(this,a.rep);null!=a.ideograms&&(ya.call(this,a,d,f),this._alts&&this._alts.loadRegions(a.ideograms));if(null!=a.annotations)for(b=0;b<a.annotations.length;b++)d=a.annotations[b].index,f=this.getAllAnnotations(),f[d]&&f[d].loadData&&f[d].loadData(a.annotations[b].data);a.image&&(this._imageURL=IDEO.ncfetch_url+"?key="+a.image.nc_key,this._imageSize=a.image.size);if(b=this.getLegends())b.createLegendMap(a),b._setIdeogram(this);
delete this._loading}function F(a,c){y.call(this,a,c);if(this.onLoad)try{this.onLoad(this)}catch(b){console.error(b)}this.autodisplay&&this.displayIfNeeded()}function P(a,c){var b=a&&a.image?a.image.nc_key:null;if(b){var d,f=c.fmt;switch(c.fmt){default:case "eps":case "png":case "tiff":d="image/"+c.fmt;break;case "svg":d="image/svg+xml";break;case "jpg":d="image/jpeg";break;case "jpeg":d="image/jpeg";f="jpg";break;case "pdf":d="application/pdf"}b=IDEO.ncfetch_url+"?key="+encodeURIComponent(b)+"&filename="+
c.file+"."+f+"&fmt="+encodeURIComponent(d);window.location=b}}function xa(a){function c(a){var b=this.type;switch(b){default:a[b]=this;break;case "ideo":a[b]=this;break;case "annot":a.annot=a.annot||[];a.annot.push(this);break;case "highlight":case "overlay":a.annot=a.annot||[],a.annot.push(this),a[b]=this}for(var b=this.sublayers||[],e=0;e<b.length;e++)b[e]._super=this,c.call(b[e],a)}function b(a){var d=this.sublayers||[];if("ideobody"==this.type){IDEO.assert(null!=this.id,"body layer must have ID");
a[this.id]=this;this.ref={};this.ref.body=this;for(var e=0;e<d.length;e++)d[e]._super=this,c.call(d[e],this.ref)}else for(e=0;e<d.length;e++)d[e]._super=this,b.call(d[e],a)}var d={root:a};a=a.sublayers[0];b.call(a,d);return d}function ya(a,c,b){function d(a,b){return a.chrom.order<b.chrom.order?-1:a.chrom.order>b.chrom.order?1:0}function f(a,b){return a[e]<b[e]?-1:a[e]>b[e]?1:a[g]>b[g]?-1:a[g]<b[g]?1:0}a=a.ideograms||[];try{a.sort(d)}catch(v){IDEO.reportError("sort compare error: "+v)}for(var h=this.rep.getBase(),
e=h.start,g=h.stop,h=/^MT$|^PLTD$|^UN$/i,k=0;k<a.length;k++)if(a[k].chrom){var l=za(a[k]),m=l.chrom;m.match(h)||(this.chroms.push(m),this._chromMap[m]=l,l.layer=c[m],l.spec=b[m],l.spec.baseScale=l.layer.frame.height*l.spec.scale,l.data=l.data||[],l.data.sort(f),Aa.call(this,l.data,m),this.rep.getAux()&&ga(this.rep,l),l.layer.ref.chrom&&(l.layer.ref.chrom.overlay=l.layer.ref.overlay,l.layer.ref.chrom.highlight=l.layer.ref.highlight))}}function za(a){var c=a.chrom.chrom,b;a:{if((b=a.chrom)&&b.seq&&
b.seq.accession&&(b=b.seq.accession,b=b.other||b.genbank||b.gpipe)){b=b.accession+(null!=b.version?"."+String(b.version):"");break a}b=null}var d=a.chrom,c={chrom:c,acc:b,gi:d&&d.seq&&d.seq.gi?d.seq.gi.gi:null,order:a.chrom.order,data:[],size:{iscn_length:0,bp_length:0,length:0,iscn_centr:0,bp_centr:0,centr:0}};b=a.data||[];a=c.size;for(var f,d={},h=0;h<b.length;h++){var e=b[h],g={type:e.type};"centromere"===g.type&&(f=g);e.iscn&&(g.iscn_start=e.iscn.iscn_start,g.iscn_stop=e.iscn.iscn_stop,a.iscn_chr_start=
null==a.iscn_chr_start?g.iscn_start:Math.min(g.iscn_start,a.iscn_chr_start),a.iscn_chr_stop=null==a.iscn_chr_stop?g.iscn_stop:Math.max(g.iscn_stop,a.iscn_chr_stop),a.iscn_length=a.iscn_chr_stop-a.iscn_chr_start);e.basepairs&&(g.bp_start=e.basepairs.bp_start+1,g.bp_stop=e.basepairs.bp_stop+1,a.bp_chr_start=null==a.bp_chr_start?g.bp_start:Math.min(g.bp_start,a.bp_chr_start),a.bp_chr_stop=null==a.bp_chr_stop?g.bp_stop:Math.max(g.bp_stop,a.bp_chr_stop),a.bp_length=a.bp_chr_stop-a.bp_chr_start);e.othercoords&&
(g.start=e.othercoords.start,g.stop=e.othercoords.stop,a.chr_start=null==a.chr_start?g.start:Math.min(g.start,a.chr_start),a.chr_stop=null==a.chr_stop?g.stop:Math.max(g.stop,a.chr_stop),a.length=a.chr_stop-a.chr_start);e.cyto&&(g.arm=e.cyto.arm,e.cyto.band?(g.band=e.cyto.band.band,e.cyto.band.stain&&(g.stain=e.cyto.band.stain),e.cyto.band.density&&(g.density=e.cyto.band.density),g.name=g.arm+g.band):g.name=g.arm,"arm"===g.type&&(d[g.arm]=g));c.data.push(g)}f?(null!=f.iscn_stop&&0<a.iscn_length&&(a.iscn_centr=
f.iscn_start+(f.iscn_stop-f.iscn_start)*f.iscn_start/a.iscn_length),null!=f.bp_stop&&0<a.bp_length&&(a.bp_centr=f.bp_start+(f.bp_stop-f.bp_start)*f.bp_start/a.bp_length),null!=f.stop&&0<a.length&&(a.centr=f.start+(f.stop-f.start)*f.start/a.length)):d.q&&(f=d.q,null!=f.iscn_start&&(a.iscn_centr=f.iscn_start),null!=f.bp_start&&(a.bp_centr=f.bp_start),null!=f.start&&(a.centr=f.start));return c}function wa(a,c,b){this.clear();this.setErrorCode(IDEO.IdeogramStatus.FAILED);this.addError("IdeogramFetchError: "+
a.status+" "+a.statusText,IDEO.IdeogramStatus.FAILED,"RequestError",IDEO.ErrorIndex.Server);delete this._loading;if(this.onLoad)try{this.onLoad(this)}catch(d){console.error(d)}}function Ba(a,c,b){IDEO.reportError("IdeogramDownloadError: "+a.status+" "+a.statusText,IDEO.IdeogramStatus.FAILED,"RequestError",IDEO.ErrorIndex.Server)}function K(a,c,b,d,f){var h=f,e=A(d)?{x:"x",y:"y",width:"width",height:"height"}:{x:"y",y:"x",width:"height",height:"width"},g={},h=h||0;g[e.x]=c.frame.x;g[e.width]=c.frame.width;
g[e.y]=Math.floor(c.frame.y)-h;g[e.height]=Math.ceil(c.frame.y+c.frame.height)+h-g[e.y];c={left:String(-g.x)+"px",top:String(-g.y)+"px"};g={width:String(g.width)+"px",height:String(g.height)+"px"};f&&(d=A(d)?"top":"left",g[d]=String(-f)+"px");jQuery(a).css(g).find("img").css(c).attr({src:b})}function ha(a,c,b){var d=c.els.chrom;b=c.els["chrom-label"];if(d&&b)if(this.isVertical())if(b.offsetWidth<=d.offsetWidth){var f=I("left",d,a);this._chl&&"html"==this._chl.src?jQuery(b).css({left:String(f)+"px"}):
this._chl&&"image"==this._chl.src&&(c=c.els["chrom-label-wrap"])&&jQuery(b).css({left:String(f+Math.round((d.offsetWidth-c.offsetWidth)/2))+"px"})}else{c=c.els.ideo;var h=I("left",b,a)+b.offsetWidth/2,d=I("left",d,a)+d.offsetWidth/2;if(h<d)jQuery(b).css({left:String(d-h)+"px"});else if(h>d){try{isNaN(f=parseInt(getComputedStyle(c).getPropertyValue("padding-left")))&&(f=0)}catch(e){f=0}jQuery(c).css({"padding-left":String(Math.round(f+h-d))+"px"})}}else if(this._chl&&"html"==this._chl.src){f=I("top",
d,a);a=this._chl.fontSize;try{a=parseInt(getComputedStyle(b).getPropertyValue("font-size"))}catch(e){}d=Math.round(f+(d.offsetHeight-a)/2);0<d?jQuery(b).css({"padding-top":String(d)+"px"}):0>d&&(c=c.els.ideo,jQuery(c).css({"padding-top":String(-d)+"px"}))}else this._chl&&"image"==this._chl.src&&(f=I("top",d,a),d=Math.round(f+(d.offsetHeight-b.offsetHeight)/2),0<d?jQuery(b).css({top:String(d)+"px"}):0>d&&(c=c.els.ideo,jQuery(c).css({"padding-top":String(-d)+"px"})))}function ia(a,c,b,d){var f=this._elements[a]||
this._proto[a],h=b.layer,e;IDEO.assert(f&&f.tag,'no rule for element "'+a+'"');IDEO.assert(h,'no body layer for chromosome "'+b.chrom+'"');for(var h=h.ref||{},h=jQuery.isArray(h[a])?h[a]:[h[a]],g=0;g<h.length;g++)if(null!=h[g]&&X.hasOwnProperty([h[g].type])&&(this._showAllLayers||h[g].touched)){var k=a,l=c;e=b;var m=f,v=h[g];try{var r=e.chrom,q=e.layer,n=document.createElement(m.tag),p=n,u=m.elements||[],B=void 0;for(B in m)switch(B){case "tag":case "wrap":case "wrapCls":case "elements":case "callback":case "info":case "alias":case "finish":break;
case "html":n.innerHTML=m.html;break;case "cls":jQuery(n).addClass(m.cls);break;default:n.setAttribute(B,m[B])}m.wrap&&(p=document.createElement(m.wrap),m.wrapCls&&jQuery(p).addClass(m.wrapCls),p.appendChild(n));l&&(jQuery.isFunction(l)?l(this,k,r,p):l.appendChild(p));n.layer=v;X[v.type]&&X[v.type].call(this,n,e,v);var l=void 0,C=this.callbacks||{},z=C[k]||C[m.alias];if(z&&z.fn){l=z.handler||window;try{z.fn.call(l,this,k,r,n,q.ref[k],m)}catch(t){console.error('Error in user callback "'+k+'": '+t)}}else m.callback&&
m.callback.fn?(l=m.callback.handler||window,m.callback.fn.call(l,this,k,r,n,q.ref[k],m)):ja[k]&&ja[k].call(this,r,n,q.ref[k],m);for(k=0;k<u.length;k++)ia.call(this,u[k],n,e);m.finish&&m.finish.call(this,n,e,m)}catch(t){console.error("Cannot create element: "+t)}e=n;d&&d.push(e)}return e}function ka(a,c,b,d,f,h){a.bandLabels&&(null!=h.wrap&&(d=d.parentNode),a=a.bandLabels.isFlipped()?"ideo-flipped":"ideo-normal",jQuery(d).addClass(a))}function la(a,c){for(var b=0;b<a.length;b++)if("string"!==typeof a[b]||
!a[b].match(c))return!1;return!0}function Y(a,c){if(this.isLoaded()){var b;null!=a&&jQuery.isArray(a)?c=a:(IDEO.assert(null==c||jQuery.isArray(c),"ideolib.display: invalid arguments (chroms)"),b=a);b=b||this.container;c=c||this.chroms;IDEO.assert(b,"ideolib.display: No container. Container must be specified either in config or as a method argument");"none"==this._chl.position||this._chlStyleSet||(Ca.apply(this),this._chlStyleSet=!0);var d=b;b=c;var f=!1;this.setReady(!1);if(!jQuery.isFunction(d)){var f=
!0,h=jQuery(d);IDEO.assert(h[0],'ideolib.display: jQuery cannot get container for "'+d+'"');h.empty();d=h[0]}for(var h=[],e=0;e<b.length;e++){var g=this._chromMap[b[e]],k=d,l=h;g.els={};if(k=ia.call(this,"body",k,g,l))k.chrom=g.chrom,jQuery(k).addClass("chr"+g.chrom).attr("chrom",g.chrom)}if(this._chl&&!this.isVertical()){d="image"==this._chl.src;try{if(this._chl.position==IDEO.LabelPosition.Before){var e=0,m=jQuery(null);if(d)for(n=0;n<b.length;n++){var v=b[n],r=this._chromMap[v],q=r.els["chrom-label"].parentNode,
e=Math.max(e,q.offsetWidth);m.push(q)}else for(var n=0;n<b.length;n++){var v=b[n],r=this._chromMap[v],e=Math.max(e,r.layer.ref["chrom-label"].frame.height);m.push(r.els["chrom-label"].parentNode)}m.css({width:String(e)+"px"})}}catch(p){console.error(p)}}f&&Z.call(this,h);this.setReady(!0);this.setNeedsDisplay(!1);this._alts&&this._alts.ideoDidDisplay(this);if(this.onDisplay)try{this.onDisplay(this)}catch(p){console.error(p)}}else console.error("ideolib.display: Ideogram is not loaded")}function Z(a,
c){try{if(!this.isLoaded())return!1;var b=a,d=null;if(b)if("string"===typeof b||b instanceof String)var f=this.classForEl("body"),d=jQuery(b+" ."+f);else b instanceof jQuery?d=b:jQuery.isArray(b)&&(d=jQuery(b));a=d;if(!a)return IDEO.reportError("Ideogram.updateLayout: invalid ideoSpec argument - must be a string, an array or a jQuery result set"),!1;for(var h=Da(a,this.isVertical()),b=0;b<h.length;b++){var e=h[b],d=Infinity,f=0,g=Infinity,k=void 0,l=void 0,m=!this.isVertical(),v=m?Infinity:0;this._chl.position==
IDEO.LabelPosition.After&&(v=g=0);switch(this.align){case IDEO.IdeogramAlignment.Centromere:for(var r=0;r<e.length;r++){var q=e[r],n=this._chromMap[q.chr];if(!n.layer.pseudo){var p=n.layer.ref.ideo;q.minY=Math.floor(p.frame.y-n.layer.frame.y);q.maxY=Math.ceil(p.frame.y+p.frame.height-n.layer.frame.y);d=Math.min(d,q.minY);f=Math.max(f,q.maxY);switch(this._chl.position){case IDEO.LabelPosition.Before:q.lbY=q.minY;g=Math.min(g,q.lbY);m&&(v=Math.min(v,q.minY-n.els["chrom-label"].offsetWidth));break;case IDEO.LabelPosition.After:q.lbY=
q.maxY,g=Math.max(g,q.lbY)}}}break;case IDEO.IdeogramAlignment.Top:for(r=d=0;r<e.length;r++)if(q=e[r],n=this._chromMap[q.chr],!n.layer.pseudo)switch(p=n.layer.ref.ideo,q.minY=0,q.maxY=Math.ceil(p.frame.height),f=Math.max(f,q.maxY),this._chl.position){case IDEO.LabelPosition.Before:v=g=q.lbY=0;break;case IDEO.LabelPosition.After:this._chl.align==IDEO.ChromLabelAlignment.InChrom?(q.lbY=q.maxY,g=Math.max(g,q.lbY)):q.lbY=g=0}break;case IDEO.IdeogramAlignment.Bottom:for(r=0;r<e.length;r++)if(q=e[r],n=
this._chromMap[q.chr],!n.layer.pseudo)switch(p=n.layer.ref.ideo,q.minY=Math.floor(n.layer.frame.height-p.frame.height),q.maxY=Math.ceil(n.layer.frame.height),d=Math.min(d,q.minY),f=Math.max(f,q.maxY),this._chl.position){case IDEO.LabelPosition.Before:this._chl.align==IDEO.ChromLabelAlignment.InChrom?(q.lbY=q.minY,g=Math.min(g,q.lbY)):q.lbY=g=0;m&&(v=Math.min(v,q.minY-n.els["chrom-label"].offsetWidth));break;case IDEO.LabelPosition.After:q.lbY=g=0}}k=f-d;l=d-v;for(r=0;r<e.length;r++)if(q=e[r],n=this._chromMap[q.chr],
this.isVertical()){jQuery(n.els.ideo).css({top:String(q.minY-d)+"px"});jQuery(n.els.ideo.parentNode).css({height:String(k)+"px"});var u=null;switch(this._chl.position){case IDEO.LabelPosition.Before:u=this._chl.align==IDEO.ChromLabelAlignment.InChrom?{top:String(Math.round(q.lbY-g))+"px"}:{top:"0px"};break;case IDEO.LabelPosition.After:u=this._chl.align==IDEO.ChromLabelAlignment.InChrom?{top:String(Math.round(q.lbY-g))+"px"}:{top:"0px"}}u&&jQuery(n.els["chrom-label"]).css(u)}else{jQuery(n.els.ideo).css({left:String(q.minY-
d)+"px"});jQuery(n.els.ideo.parentNode).css({width:String(k)+"px"});u=null;switch(this._chl.position){case IDEO.LabelPosition.Before:if(this._chl.align==IDEO.ChromLabelAlignment.InChrom){var B=n.els["chrom-label"].offsetWidth,C=q.lbY-g;B>l&&0<l&&(C=Math.max(0,l+C-B));u={left:String(C)+"px","text-align":"right"}}else u={left:"0","text-align":"left"};0<l&&(u.width=String(l)+"px");break;case IDEO.LabelPosition.After:u=this._chl.align==IDEO.ChromLabelAlignment.InChrom?{left:String(Math.round(q.lbY-g))+
"px","text-align":"left"}:{top:"0px","text-align":"left"}}u&&jQuery(n.els["chrom-label"].parentNode).css(u)}}return!0}catch(z){console.error(z)}return!1}function Ea(a,c){a&&c&&c.tag&&jQuery.extend(!0,this._elements[a]={},c)}function Fa(a){delete this._elements[a]}function Ga(a){var c=this._invocations=this._invocations||[],b={method:a,args:[]};args=arguments||[];for(var d=1;d<args.length;d++)b.args.push(args[d]);c.push(b)}function Ha(){var a=this._invocations||[];this._invocationsRunning=!0;IDEO.debugLog("+ Running deferred invocations, total: "+
a.length);for(var c=0;c<a.length;c++){var b=a[c];b.method.apply(this,b.args)}delete this._invocationsRunning}function Ia(a){var c={},b=[],d;for(d in a)if(a.hasOwnProperty(d))switch(d){case "align":case "ideowidth":case "ideoheight":a[d]?c[d]=a[d]:b.push(d);break;case "resolution":this.rep&&jQuery.isFunction(this.rep.setResolution)?this.rep.setResolution(a.resolution):console.error('Property "'+d+'" is not supported by representation');break;default:console.error('Property "'+d+'" is not allowed')}jQuery.extend(!0,
this,c);for(a=0;a<b.length;a++)delete this[b[a]];this.setReady(!1);(this.autofetch||this.autodisplay)&&this.fetch();this.autodisplay&&this.isLoaded()&&this.displayIfNeeded()}function ga(a,c){var b=a.getBase(),d=a.getAux();if(b&&d){var f=c.data;if(0<f.length){for(var h=[],e=0;e<f.length;e++){var g=f[e];null!=g[d.start]&&null!=g[d.stop]&&(h.push({base:g[b.start],aux:g[d.start]}),h.push({base:g[b.stop],aux:g[d.stop]+1}))}if(!(2>h.length)){h.sort(function(a,b){return a.base<b.base?-1:a.base>b.base?1:
0});for(e=h.length;1<e--;)h[e-1].base<h[e].base?h[e-1].aux>=h[e].aux&&h.splice(e,1):h[e-1].aux>h[e].aux?h.splice(e,1):h.splice(e-1,1);c.mapping=h}}}}function ma(a,c,b,d){try{var f=this._chromMap[a],h=f?f.mapping:null;if(h&&1<h.length){var e=h.length;a=e-1;var f=0,g=e;if(c<h[0][b])g=-1;else if(c<h[e-1][b]){for(;0<a-f;){var g=f+Math.ceil((a-f)/2),k=h[g][b];if(c<k)a=g-1;else if(c>=k)f=g;else break}g=f}return 0>g?h[0][d]+(c-h[0][b])*(h[e-1][d]-h[0][d])/(h[e-1][b]-h[0][b]):g<e-1?h[g][d]+(c-h[g][b])*(h[g+
1][d]-h[g][d])/(h[g+1][b]-h[g][b]):h[e-1][d]+(c-h[e-1][b])*(h[e-1][d]-h[0][d])/(h[e-1][b]-h[0][b])}}catch(l){console.error("Error converting "+b+" to "+d+": "+l)}return null}function Aa(a,c){var b=this._bandMap[c]={};if(a)for(var d=0;d<a.length;d++){var f=a[d];"arm"===f.type&&f.arm?b[f.arm]=f:"band"===f.type&&f.arm&&f.band&&(b[f.arm+f.band]=f)}}function na(a,c){var b={type:a,pseudo:!0};c&&(c[a]=b);var d=Ja[a];if(d)for(var f=0;f<d.length;f++){var h=na(d[f],c);h._super=b;b.sublayers=b.sublayers||[];
b.sublayers.push(h)}return b}function Ka(){var a="font-family:"+(IDEO.FontMap[this._fontFace]||"courier")+";";this._chl&&(a+="font-size:"+String(this._chl.fontSize||this._fontSize)+"px;",a=this._chl.bold?a+"font-weight:bold;":a+"font-weight:normal;",this._chl.color&&(a+="color:"+this._chl.color+";"));return a}function Ca(){try{for(var a,c=/\/ideo.css$/,b=document.styleSheets.length,d=0;d<b;d++){var f=document.styleSheets[d];if(f.href&&c.test(f.href)){a=f;break}}a=a||document.styleSheets[b-1];var h=
a.rules||a.cssRules,e=this.selectorForElement("chrom-label");if(this._chl&&(this._chl.position==IDEO.LabelPosition.None||"html"!=this._chl.src||!this._chl.css)){if(e){for(var g=h.length;0<g--&&h[g].selectorText!=e;);0<=g&&(a.deleteRule?a.deleteRule(g):a.removeRule(g))}}else if(e){var k=Ka.apply(this);a.addRule?a.addRule(e,k,h.length):a.insertRule(e+"{"+k+"}",h.length)}}catch(l){console.error(l)}}function Da(a,c){for(var b=[],d=[],f,h=a.length;h--;){f=a[h];var e=jQuery(f);f={el:f,chr:e.attr("chrom")};
if(f.chr){var g=e.position();c?(f.y0=g.top,f.y1=g.top+e.height()):(f.y0=g.left,f.y1=g.left+e.width());d.push(f)}else IDEO.reportError('getElementRows: not ideo-body element "'+f.el.tagName+'" - no "chrom" attribute, skipped')}d.sort(function(a,b){return a.y0>b.y0?1:a.y0<b.y0?-1:0});for(var e=[],k,g=d.length,h=0;h<g;h++)f=d[h],k?f.y0>=k.y1&&(b.push(e),e=[],k={y0:f.y0,y1:f.y1}):k={y0:f.y0,y1:f.y1},e.push(f);0<e.length&&b.push(e);return b}function La(){var a={},c;for(c in this._chromMap)this._chromMap.hasOwnProperty(c)&&
(a[c]=this._chromMap[c].order);return a}function oa(a,c,b){for(var d in c)if(c.hasOwnProperty(d)){var f=c[d];f.hasOwnProperty(a)&&(f=f[a],null!=f&&(b[f]=d))}}function Ma(){this._chromAccMap={};oa("acc",this._chromMap,this._chromAccMap)}function Na(){this._chromGIMap={};oa("gi",this._chromMap,this._chromGIMap)}function Oa(){var a={};jQuery.extend(a,this);return a}function L(a){return"get"+a.substr(0,1).toUpperCase()+a.substr(1)}function aa(a){return"set"+a.substr(0,1).toUpperCase()+a.substr(1)}function Q(a){return"create"+
a.substr(0,1).toUpperCase()+a.substr(1)}function M(a){for(;a&&(!a.layer||"ideobody"!=a.layer.type);)a=a.parentNode;return a}function pa(a){for(;a&&(!a.layer||!this._proto[a.layer.type]);)a=a.parentNode;return a}function I(a,c,b){c=c.getBoundingClientRect();b=b.getBoundingClientRect();return c[a]-b[a]}function aa(a){return"set"+a.substr(0,1).toUpperCase()+a.substr(1)}function Q(a){return"create"+a.substr(0,1).toUpperCase()+a.substr(1)}function qa(a,c){for(var b=c||[],d=0;d<b.length;d++)b[d].forward?
b[d].forward(IDEO.Annotation.prototype.setUploading,!0):b[d].setUploading(!0);a.success=function(a,c){try{for(var d=0;d<b.length;d++)b[d].forward?(b[d].forward(IDEO.Annotation.prototype.updateAnnot,a),b[d].forward(IDEO.Annotation.prototype.setUploading,!1)):(b[d].updateAnnot(a),b[d].setUploading(!1))}catch(g){console.error(g)}};a.error=function(){try{for(var a=0;a<b.length;a++)Pa.apply(b[a],arguments),b[a].forward?(b[a].forward(IDEO.Annotation.prototype.setFailed,!0),b[a].forward(IDEO.Annotation.prototype.setUploading,
!1)):(b[a].setFailed(!0),b[a].setUploading(!1)),b[a].setErrorCode(IDEO.ErrorCode.error)}catch(h){console.error(h)}};jQuery.ajax(a)}function Qa(){var a=new Function,c=a.prototype=this,a=new a;a.forward=function(a){for(var b=[],f=1;f<arguments.length;f++)b.push(arguments[f]);a.apply(c,b)};a.toString=function(){return"[proxy:"+c.toString()+"]"};return a}function Ra(a){for(var c=this._observers=this._observers||[],b=0;b<c.length;b++)if(c[b]==a)return;c.push(a)}function H(a){this.data=a}function J(a){this.url=
a}function Sa(a){var c=!0,b="[",d;for(d in a)a.hasOwnProperty(d)&&!jQuery.isFunction(a[d])&&(c||(b+=", "),b+=d+": "+a[d],c=!1);return b+"]"}function Ta(a){if(!a)return null;if("string"===typeof a)return a;if((a=jQuery(a)[0])&&a.id)return a.id;console.error("ideogram container must be a string or HTML element. HTML element must have ID");return null}function E(a,c,b,d){if(a._state)for(c=a._state[c]||[],d&&jQuery.extend(b.data,d),d=0;d<c.length;d++)try{var f=c[d],h=f.scope||window;null!=f.ctxt?b.data.context=
f.ctxt:delete b.data.context;f.fn.apply(h,[a,b])}catch(e){console.error(e)}}function R(a,c,b,d,f){this._state=this._state||{};this._state[a]=this._state[a]||[];this._state[a].push({fn:c,scope:d,ctxt:b,targets:f})}function Ua(a){var c=this._chromMap[a],b={base:1,aux:1};if(c){a=this.getRep();var d=a.getBase();b.base=c.size[d.length];if(a=a.getAux())b.aux=c.size[a.length]}else console.error("Chromosome "+a+" is not available");return b}function ra(a){var c=this._chromMap[a],b={base:{},aux:{}};if(c){a=
this.getRep();var d=a.getBase();b.base.start=c.size[d.chrStart];b.base.stop=c.size[d.chrStop];b.base.length=b.base.stop-b.base.start;if(a=a.getAux())b.aux.start=c.size[a.chrStart],b.aux.stop=c.size[a.chrStop],b.aux.length=b.aux.stop-b.aux.start}else console.error("Chromosome "+a+" is not available");return b}function ba(a){var c={};a=window.getComputedStyle(a,null);var b=a.getPropertyValue?a.getPropertyValue("border-left-width"):a.borderLeftWidth;c.left=2<b.length?Number(b.substr(0,b.length-2)):0;
b=a.getPropertyValue?a.getPropertyValue("border-right-width"):a.borderRightWidth;c.right=2<b.length?Number(b.substr(0,b.length-2)):0;b=a.getPropertyValue?a.getPropertyValue("border-top-width"):a.borderTopWidth;c.top=2<b.length?Number(b.substr(0,b.length-2)):0;b=a.getPropertyValue?a.getPropertyValue("border-bottom-width"):a.borderBottomWidth;c.bottom=2<b.length?Number(b.substr(0,b.length-2)):0;return c}"undefined"===typeof IDEO&&(IDEO={_ideoid:0});jQuery.extend(IDEO,{base_path:"https://www.ncbi.nlm.nih.gov/projects/ideogram/",
cgi_path:"3.1/",ideo_cgi:"getideo.cgi",ncfetch_url:"https://www.ncbi.nlm.nih.gov/projects/sviewer/ncfetch.cgi",ideo_version:"3.1",_async:!1,pingEnabled:!1,setAsync:function(a){IDEO._async=!!a},isAsync:function(){return IDEO._async},getCgiDir:function(){return IDEO.base_path+IDEO.cgi_path}});jQuery.isFunction(window.getComputedStyle)||(window.getComputedStyle=function(a,c){this.el=a;this.getPropertyValue=function(b){var c=/(\-([a-z]){1})/g;"float"==b&&(b="styleFloat");c.test(b)&&(b=b.replace(c,function(a,b,c){return c.toUpperCase()}));
return a.currentStyle[b]?a.currentStyle[b]:null};return this});jQuery.isFunction(Date.now)||(Date.now=function(){return(new Date).getTime()});IDEO.Enum=function(a,c){jQuery.extend(this,a);for(var b in a)a.hasOwnProperty(b)&&(this[b.toUpperCase()]=this[b]);this._getEnumName=function(){return c}};IDEO.Enum.prototype={isValid:function(a){for(var c in this)if(this.hasOwnProperty(c)&&a==this[c])return!0;return!1},validatedValue:function(a,c){var b=c,d=void 0!==c||void 0!==this.Default||void 0!==this.DEFAULT;
this.isValid(a)?(b=a,d=!0):b=b||this.Default||this.DEFAULT;!d&&this._getEnumName&&console.error('*** Invalid value "'+a+'" for enum '+this._getEnumName());return b}};IDEO.Delimiter={Pipe:"|",Tab:"\t",Comma:","};IDEO.Shape=new IDEO.Enum({None:"none",Rect:"rect",Triangle:"triangle",Rhomb:"rhomb",Circle:"circle",Mark:"mark",Arrow:"arrow",Overlay:"overlay",Highlight:"highlight",MarkStart:"mark-start",MarkEnd:"mark-end",Image:"image"},"IDEO.Shape");IDEO.IdeogramOrientation=new IDEO.Enum({Default:"horizontal",
Horizontal:"horizontal",Vertical:"vertical"},"IDEO.IdeogramOrientation");IDEO.IdeogramAlignment=new IDEO.Enum({Default:"centromere",Top:"top",Centromere:"centromere",Bottom:"bottom",Fit:"fit"},"IDEO.IdeogramAlignment");IDEO.ChromLabelAlignment=new IDEO.Enum({None:0,InGroup:1,InChrom:2},"IDEO.ChromLabelAlignment");IDEO.IdeogramResolution=new IDEO.Enum({Default:void 0,ISCN400:"400",ISCN550:"550",ISCN850:"850",Arms:"arms"},"IDEO.IdeogramResolution");IDEO.Coord=new IDEO.Enum({Base:"base",Aux:"aux",Iscn:"iscn",
Seq:"seq",NonSeq:"nonseq"},"IDEO.Coord");IDEO.LabelPosition=new IDEO.Enum({Default:"before",None:"none",Before:"before",After:"after"},"IDEO.LabelPosition");IDEO.TitlePosition=new IDEO.Enum({Default:"none",None:"none",Above:"above",Below:"below"},"IDEO.TitlePosition");IDEO.AnnotationColumnMap={chrom:"CHROM",chromAcc:"CHROM-ACC",origChrom:"ORIG_CHROM",start:"START",stop:"STOP",bandStart:"BAND-START",bandStop:"BAND-STOP"};IDEO.IdeogramStatus={Ok:"ok",Warnings:"warning",Loading:"loading",Errors:"error",
Failed:"failed",NoChroms:"nochroms",OK:"ok",WARNINGS:"warning",LOADING:"loading",ERRORS:"error",FAILED:"failed",NOCHROMS:"nochroms"};IDEO.ErrorCode={ok:0,warning:1,error:2,errors:2,failed:3};IDEO.AnnotationStatus={Ok:"ok",Warnings:"warning",Errors:"error",Failed:"failed",OK:"ok",WARNINGS:"warning",ERRORS:"error",FAILED:"failed"};IDEO.AnnotationType=new IDEO.Enum({Track:"track",Overlay:"overlay",Highlight:"highlight",Alts:"alts"},"IDEO.AnnotationType");IDEO.TrackIndex={Overlay:-1};IDEO._AnnotType=
{Track:0,Overlay:1,Highlight:2,Alts:3};IDEO.EventType=new IDEO.Enum({BandOver:"bandover",BandOut:"bandout",AnnotOver:"annotover",AnnotOut:"annotout",AnnotAt:"annotat",BandMenu:"bandmenu",BandClick:"bandclick",AnnotMenu:"annotmenu",AnnotClick:"annotclick",AltsOver:"altsover",AltsOut:"altsout",AltsAt:"altsat",AltsClick:"altsclick",AltsMenu:"altsmenu",RegionChange:"regionchange"},"IDEO.EventType");IDEO.TextAlign=new IDEO.Enum({Left:"left",Right:"right",Top:"left",Bottom:"right"},"IDEO.TextAlign");IDEO.FontFace=
new IDEO.Enum({Helvetica:2,Lucida:3,Palatino:3,Courier:4,Clean:5,Fixed:6,Times:7},"IDEO.FontFace");IDEO.LabelFontFace=IDEO.FontFace;IDEO.FontFamily={Helvetica:"helvetica",Lucida:"lucida",Palatino:"palatino",Courier:"courier",Clean:"courier",Fixed:"courier",Times:"times"};IDEO.FontSize=new IDEO.Enum({Mini:6,Small:8,Medium:10,Large:12,Default:10},"IDEO.FontSize");IDEO.LabelFontSize=IDEO.FontSize;IDEO.LabelOrientation=new IDEO.Enum({Lengthwise:"along",Along:"along",Transversal:"across",Across:"across"},
"IDEO.LabelOrientation");IDEO.ErrorIndex=new IDEO.Enum({Annotation:0,Ideogram:-1,Data:-2,Service:-3,NetCache:-4,Legend:-5,Renderer:-6,Server:-7,JavaScript:-8},"IDEO.ErrorIndex");IDEO.FontMap={};for(var D in IDEO.FontFamily)IDEO.FontMap[IDEO.FontFace[D]]=IDEO.FontFamily[D];(function(){function a(a){if(!d){d={};for(var b in IDEO.ErrorIndex)d[IDEO.ErrorIndex[b]]=b}return(a=d[String(a)])?a:"Unknown"}function c(){IDEO.pingEnabled&&null==f&&(f=window.ncbi&&window.ncbi.sg&&"function"==typeof window.ncbi.sg.ping?
window.ncbi.sg.ping:function(){});return f}function b(a){var b=c();b&&b(a)}window.console=window.console||{log:function(){}};console.assert||(console.assert=function(a,b){a||console.error(b)});console.error||(console.error=console.log);console.warn||(console.warn=console.log);console.debug||(console.debug=console.log);console.info||(console.info=console.log);IDEO.assert=function(a,b){console.assert(a,b);if(!a)throw b||a;};IDEO.log=function(){switch(this.severity){case IDEO.ErrorCode.error:case IDEO.ErrorCode.failed:console.error(this);
break;case IDEO.ErrorCode.warning:console.warn(this);break;default:console.log(this)}};IDEO.logError=function(a){console.error("*** "+a);if(jQuery.isFunction(IDEO.onError))try{IDEO.onError(a)}catch(e){}};IDEO.logWarning=function(a){console.warn("! "+a)};IDEO.RequestError=function(b){b&&"object"===typeof b&&(this.name=b.name,this.severity=b.severity,this.description=b.description,this.chrom=b.chrom,null!=b.component_index&&(0<=b.component_index?(this.comp="Annotation",this.index=b.component_index):
this.comp=a(b.component_index)))};IDEO.RequestError.prototype={toString:function(){return this.getSeverity()+": "+this.name+"["+this.comp+(null!=this.index?"("+this.index+")":"")+(null!=this.chrom?"(chr"+this.chrom+")":"")+"], "+this.description},getSeverity:function(){switch(this.severity){case IDEO.ErrorCode.failed:return"Error";case IDEO.ErrorCode.error:return"Failure";case IDEO.ErrorCode.warning:return"Warning";default:return"Info"}},log:IDEO.log};IDEO.Error=function(b,c,d,f){this.name=d||"Error";
this.severity=c||0;this.description=b;this.index=null!=f?f:IDEO.ErrorIndex.JavaScript;this.comp=a(this.index)};IDEO.Error.prototype={toString:function(){return this.getSeverity()+": "+this.name+"["+this.comp+"]"+this.description},getSeverity:IDEO.RequestError.prototype.getSeverity,log:IDEO.log};IDEO.reportInfo=function(a){console.info(a)};IDEO.reportError=function(a,b,c,d){this.addError&&this!=window?this.addError(a,b,c,d):console.error(a)};IDEO.addError=function(a,b,c,d){a=new IDEO.Error(a,b,c,d);
this._errors=this._errors||[];this._errors.push(a);a.log()};IDEO.debugLog=function(a){IDEO.debug&&console.info(a)};var d,f;IDEO.ping=b;IDEO.pingError=function(a){b({jsevent:"error",error:String(a),ncbi_app:"Ideogram"})}})();(function(){function a(a){a=L(a||"base");return jQuery.isFunction(this[a])?(a=this[a].apply(this),this.precision[a?a.name:"base"]):null}function c(a){null!=a&&(a.assmacc?(this.assmacc=a.assmacc,a.assm&&console.warn('CytoRep: "assm" is ignored - "assmacc" is specified')):a.assm&&
(this.assm=a.assm),a.resolution&&this.setResolution(a.resolution),a.showAs&&this.setShowAs(a.showAs))}function b(a){null!=a&&(a.assmacc?(this.assmacc=a.assmacc,a.assm&&console.warn('SeqRep: "assm" is ignored - "assmacc" is specified')):a.assm&&(this.assm=a.assm),a.hideCentromere&&(this.centromere=!1))}function d(a){null!=a&&(this.setMap(a.map),a.hideCentromere&&(this.centromere=!1))}function f(a){null!=a&&(IDEO.assert(null!=a.assm||null!=a.assmacc,"AssemblyRep: assm or assmacc must be specified in config"),
a.assmacc?(this.assmacc=a.assmacc,a.assm&&console.warn('AssemblyRep: "assm" is ignored - "assmacc" is specified')):a.assm&&(this.assm=a.assm),a.hideCentromere&&(this.centromere=!1),a.resolution&&this.setResolution(a.resolution))}function h(a){a.assembly&&(a.assembly.name&&(this.assm=a.assembly.name),a.assembly.gpipe_accession&&(this.assmacc=a.assembly.gpipe_accession))}function e(a){h.apply(this,[a]);a.resolution&&(this.resolution=a.resolution)}function g(a){h.apply(this,[a])}function k(a){a.map_name&&
(this.map&&this.map!=a.map_name&&IDEO.logWarning("Map name: "+a.map_name),this.map=a.map_name)}function l(a){this.rep&&"any"!=this.rep.rep||(this.rep=a.cytogenetic?new c:a.sequence?new b:new d);this.rep&&this.rep.reset(a)}IDEO.CytoRep=function(a){return new c(a)};IDEO.SeqRep=function(a){return new b(a)};IDEO.NonseqRep=function(a){IDEO.assert(null!=a,"NonseqRep: config argument must be supplied");IDEO.assert(a.map,"NonseqRep: map must be specified in config");return new d(a)};IDEO.AssemblyRep=function(a){IDEO.assert(null!=
a,"AssemblyRep: config argument must be supplied");return new f(a||{})};c.prototype={getBase:function(){return this.coord.base},getAux:function(){return this.coord.aux},getSeq:function(){return this.coord.aux},getIscn:function(){return this.coord.base},getCyto:function(){return this.coord.base},getNonseq:function(){return null},getResolution:function(){return this.resolution},setResolution:function(a){a?this.resolution=a:delete this.resolution},getShowAs:function(){return this.showAs},setShowAs:function(a){"arms"===
a?this.showAs="arms":"default"!==a&&console.error('CytoRep: invalid "showAs" value: must be "arms" or "default"')},addToRequest:function(a){var b=this.getResolution();a.rep=[this.rep,this.assmacc?"acc:"+this.assmacc:this.assm?"name:"+this.assm:"",b?b:"",this.showAs?this.showAs:""].join("|");return this.valid},getPrecision:a,coord:{base:{name:"base",type:"iscn",key:"iscn",start:"iscn_start",stop:"iscn_stop",length:"iscn_length",centr:"iscn_centr",chrStart:"iscn_chr_start",chrStop:"iscn_chr_stop"},
aux:{name:"aux",type:"seq",key:"basepairs",start:"bp_start",stop:"bp_stop",length:"bp_length",centr:"bp_centr",chrStart:"bp_chr_start",chrStop:"bp_chr_stop"}},precision:{base:5,aux:0},getDefaultAlign:function(){return this._align},setDefaultAlign:function(a){this._align=a},getAssembly:function(){return{name:this.assm,accession:this.assmacc}},reset:function(a){e.apply(this,[a.cytogenetic])},_align:IDEO.IdeogramAlignment.Default,valid:!0,rep:"cyto"};b.prototype={getBase:function(){return this.coord.base},
getAux:function(){return this.coord.aux},getSeq:function(){return this.coord.base},getCyto:function(){return this.coord.aux&&"iscn"===this.coord.aux.type?this.coord.aux:null},getIscn:function(){return this.getCyto()},getNonseq:function(){return this.coord.aux&&"nonseq"===this.coord.aux.type?this.coord.aux:null},addToRequest:function(a){a.rep=[this.rep,this.assmacc?"acc:"+this.assmacc:this.assm?"name:"+this.assm:"",this.centromere?"":"hide"].join("|");return this.valid},getPrecision:a,coord:{aux:{name:"aux",
type:"iscn",key:"iscn",start:"iscn_start",stop:"iscn_stop",length:"iscn_length",centr:"iscn_centr",chrStart:"iscn_chr_start",chrStop:"iscn_chr_stop"},base:{name:"base",type:"seq",key:"basepairs",start:"bp_start",stop:"bp_stop",length:"bp_length",centr:"bp_centr",chrStart:"bp_chr_start",chrStop:"bp_chr_stop"}},centromere:!0,precision:{base:0,aux:5},getDefaultAlign:function(){return this._align},setDefaultAlign:function(a){this._align=a},reset:function(a){g.apply(this,[a.sequence])},getAssembly:function(){return{name:this.assm,
accession:this.assmacc}},_align:IDEO.IdeogramAlignment.Default,rep:"seq",valid:!0};d.prototype={getBase:function(){return this.coord.base},getAux:function(){return this.coord.aux},getSeq:function(){return this.coord.aux&&"seq"===this.coord.aux.type?this.coord.aux:null},getIscn:function(){return this.coord.aux&&"iscn"===this.coord.aux.type?this.coord.aux:null},getCyto:function(){return this.getIscn()},getNonseq:function(){return this.coord.base},setMap:function(a){this._map=a},getMap:function(){return this._map},
addToRequest:function(a){a.rep=[this.rep,"map:"+(this._map?this._map:""),this.centromere?"":"hide"].join("|");return this.valid},getPrecision:function(a){a=L(a||"base");return jQuery.isFunction(this[a])?this.precision[this[a].apply(this).name]:null},coord:{base:{name:"base",type:"nonseq",key:"othercoords",start:"start",stop:"stop",length:"length",centr:"centr",chrStart:"chr_start",chrStop:"chr_stop"}},precision:{base:5},getDefaultAlign:function(){return this._align},setDefaultAlign:function(a){this._align=
a},reset:function(a){k.apply(this,[a.non_sequence])},getAssembly:function(){return null},centromere:!0,_align:IDEO.IdeogramAlignment.Centromere,rep:"nonseq",valid:!0};f.prototype={getDefaultAlign:function(){return this._align},setDefaultAlign:function(a){this._align=a},addToRequest:function(a){a.rep=[this.rep,this.assmacc?"acc:"+this.assmacc:this.assm?"name:"+this.assm:"",this.centromere?"":"hide",this.resolution?this.resolution:""].join("|");return this.valid},_align:IDEO.IdeogramAlignment.Centromere,
rep:"any",centromere:!0,valid:!0};IDEO._updateRep=function(a){this.rep&&("cyto"==this.rep.rep&&null==a.cytogenetic||"seq"==this.rep.rep&&null==a.sequence)&&(this.rep=null);l.apply(this,[a])}})();IDEO.Ideogram=function(a){this.container=null;var c=++IDEO._ideoid;this._getId=function(){return c};this._bandMap={};jQuery.extend(!0,this._elements={},Va);jQuery.extend(!0,this._proto={},S);for(var b=["shapes"],d=0;d<b.length;d++){var f=b[d];if(null!=a[f])switch(f){case "shapes":this.setShapeList(a[f])}}for(f in a)switch(f){case "shapes":break;
case "taxid":case "rep":case "chroms":case "numrows":case "numcols":case "container":case "autoprepare":case "autofetch":case "autodisplay":case "adjust":case "lookupWidth":this[f]=a[f];break;case "callbacks":this[f]=a[f];break;case "onDataLoad":case "onDataError":case "onErrorContext":this[f]=a[f];break;case "fontFace":this._fontFace=a[f];break;case "fontSize":this._fontSize=a[f];break;case "orientation":this.setOrientation(a[f]);jQuery.extend(!0,this._proto={},A(this.orientation)?S:ca);break;case "annotations":this.setAnnotations(a.annotations);
break;case "highlight":this.setHighlight(a.highlight);break;case "align":this.align=IDEO.IdeogramAlignment.validatedValue(a.align);break;case "ideowidth":case "ideoheight":IDEO.assert("number"==typeof a[f]&&0<a[f],"ideowidth and ideoheight must be positive numbers");this[f]=a[f];break;case "labelPosition":this.setChromLabel(a.labelPosition);break;case "elementOrder":this.setElementOrder(a.elementOrder);break;case "ideogramOrder":this.setIdeogramOrder(a.ideogramOrder);break;case "elements":jQuery.extend(!0,
this._elements,a.elements);break;case "chromLabel":this.setChromLabel(a.chromLabel);break;case "legends":this.setLegends(a.legends);break;case "async":this.setAsync(a.async);break;case "bandLabels":this.bandLabels=new IDEO.BandLabelConfig(a.bandLabels);break;case "colors":this.setColors(a.colors);break;case "alts":this._alts=new IDEO._Alts(a[f]);this.shapeList||this.setShapeList();this._alts.setIdeogram(this);break;case "pseudo":this._pseudo=!!a[f];break;case "compact":this._showAllLayers=!a.compact;
break;case "onLoad":case "onDisplay":IDEO.assert(null==a[f]||jQuery.isFunction(a[f]),'"'+f+'" must be a function or null');this[f]=a[f];break;case "fmt":this.setImageFormat(a[f]);break;case "dev":this._dev=a[f];break;case "service":this._service=a[f];break;case "timeout":this.setTimeout(a[f]);break;case "debug":console.error('Ideogram: "debug" property is deprecated. Use IDEO.debug = true');break;default:console.error('Ideogram: - unknown config property "'+f+'"')}IDEO.assert(null!=this.taxid,"Ideogram: 'taxid' property is required");
IDEO.assert(null==this.rep||this.rep.valid,"Ideogram: invalid representation");if(this.autoprepare)try{var h=this.getAnnotations();if(0<h.length)for(d=0;d<h.length;d++)h[d].setShouldPrepare(!0)}catch(e){console.error(e)}if(a=this.getLegends())a.setShapes(this.getShapeList()),a.setNeedsSwap(!this.isVertical());(this.autofetch||this.autodisplay)&&this.fetch();this.autodisplay&&this.isLoaded()&&this.displayIfNeeded()};IDEO.Ideogram.prototype={fetch:function(a){var c=this.isAsync();IDEO.debugLog("Loading ideogram, async = "+
(c?"true":"false"));this.clearErrors();var b=this.getAllAnnotations();IDEO.Annotation.UploadAnnotations(this,c,b,a)&&x.call(this,b,a)},download:function(a){IDEO.assert(a,"IDEO.download: config is required");var c={};jQuery.extend(c,a);c.fmt&&IDEO.assert(sa.test(c.fmt),"Invalid 'fmt' value: '"+c.fmt+"'");c.fmt=c.fmt||"png";c.file=c.file||"Ideogram";c.dev=c.dev||"";if(c.cb)try{c.cb(c)}catch(b){console.error(b)}c.onload=P;c.onerror=c.onerror||Ba;this.fetch(c)},isLoaded:function(){return null!=this._chromMap},
getStatus:function(){if(this._loading)return IDEO.IdeogramStatus.LOADING;for(var a=this.getErrorCode(),c=(this.getChroms()||[]).length,b=this.getAllAnnotations(),d=0;d<b.length;d++)a=Math.max(a,b[d].getErrorCode());switch(a){case IDEO.ErrorCode.ok:return 0<c?IDEO.IdeogramStatus.Ok:IDEO.IdeogramStatus.NoChroms;case IDEO.ErrorCode.warning:return 0<c?IDEO.IdeogramStatus.Warnings:IDEO.IdeogramStatus.NoChroms;case IDEO.ErrorCode.error:return IDEO.IdeogramStatus.Errors;default:return IDEO.IdeogramStatus.Failed}},
setErrorCode:function(a){this._errorInfo=this._errorInfo||{};this._errorInfo.code=a||0},getErrorCode:function(){return this._errorInfo?this._errorInfo.code||0:0},getErrorInfo:function(){return this._errorInfo},getRep:function(){return this.rep},getChroms:function(){return this.chroms},displayIfNeeded:function(){this.needsDisplay()&&Y.apply(this,arguments)},needsDisplay:function(){return this._needsDisplay},setNeedsDisplay:function(a){a||null==a?this._needsDisplay=!0:delete this._needsDisplay},setIdeogramOrder:function(a){if(a){jQuery.isArray(a)||
(a=jQuery.makeArray(arguments));var c=a;IDEO.assert(la(c,/^band-label$|^chrom$|^annot$/),'ideolib.setIdeogramOrder: only elements "band-label", "chrom" and "annot" are allowed');this._proto.ideo.elements=this._elementOrder=c}},setElementOrder:function(a){IDEO.assert(a,"IDEO.setElementOrder - argument required");jQuery.isArray(a)||(a=jQuery.makeArray(arguments));this.setBodyOrder(a)},_setLabelPosition:function(a){switch(a){case IDEO.LabelPosition.None:this.setElementOrder("ideo");break;case IDEO.LabelPosition.Before:this.setElementOrder("chrom-label",
"ideo");break;case IDEO.LabelPosition.After:this.setElementOrder("ideo","chrom-label");break;default:console.error('Ideogram.setChromLabel - invalid label position "'+a+'"')}},setChromLabel:function(a){this._chl={position:IDEO.LabelPosition.None,align:IDEO.ChromLabelAlignment.InGroup,color:"#202020",fontSize:IDEO.LabelFontSize.Medium,css:!0,src:"html"};if("string"==typeof a)this._setLabelPosition(a),this._chl.position=a;else for(var c in a)switch(c){case "position":this._setLabelPosition(this._chl.position=
a.position);break;case "align":case "color":case "fontSize":this._chl[c]=a[c];break;case "fontWeight":"bold"==a[c]&&(this._chl.bold=!0);break;case "src":/^html$|^image$/.test(a[c])?this._chl[c]=a[c]:console.error('Ideogram.setCromLabel - invalid property value: src = "'+a[c]+'"');break;case "css":this._chl.css=!!a[c];break;default:console.error('Ideogram.setCromLabel - invalid property "'+c+'"')}},addElement:function(a,c){Ea.apply(this,arguments)},removeElement:function(a){Fa.apply(this,arguments)},
addAnnotation:function(a){IDEO.assert(a instanceof IDEO.Annotation,"ideolib.addAnnotation: argumemt must be an Annotation object");this._annotations=this._annotations||[];a=a.proxy();if(a.isTrack()){for(var c=this._annotations.length;0<c--;)if(this._annotations[c].isTrack()){a.setTrackIndex(this._annotations[c].getTrackIndex()+1);break}0>c&&a.setTrackIndex(0)}else a.setTrackIndex(IDEO.TrackIndex.Overlay);this._annotations.push(a);this.autoprepare&&a.setShouldPrepare(!0)},showChromosomes:function(a){IDEO.deprecate("showChromosomes",
"displayChroms","Ideogram");Y.apply(this,arguments)},displayChroms:function(a){Y.apply(this,arguments)},update:function(a){Ia.apply(this,arguments);this._updateState&&this._updateState()},convertBaseToAux:function(a,c){var b=this.rep.getBase(),d=this.rep.getAux();return d?ma.call(this,a,c,b.name,d.name):(this.rep.flags=this.rep.flags||{},this.rep.flags.aux||(console.warn("Representation does not support aux coordinates"),this.rep.flags.aux=!0),null)},convertAuxToBase:function(a,c){var b=this.rep.getBase(),
d=this.rep.getAux();return d?ma.call(this,a,c,d.name,b.name):(this.rep.flags=this.rep.flags||{},this.rep.flags.aux||(console.warn("Representation does not support aux coordinates"),this.rep.flags.aux=!0),null)},baseCoordForOffset:function(a,c){var b=this.isLoaded()?this._chromMap[a]:null;return b&&b.spec?c/b.spec.baseScale+b.spec.start:Number.NaN},offsetForBaseCoord:function(a,c){var b=this.isLoaded()?this._chromMap[a]:null;return b&&b.spec?(c-b.spec.start)*b.spec.baseScale:Number.NaN},auxCoordForOffset:function(a,
c){var b=this.baseCoordForOffset(a,c);return isNaN(b)?Number.NaN:this.convertBaseToAux(a,b)},offsetForAuxCoord:function(a,c){var b=this.convertAuxToBase(a,c);return isNaN(b)?Number.NaN:this.offsetForBaseCoord(a,b)},getOrderedBands:function(a){try{IDEO.assert(this.isLoaded(),"getOrderedBands: Ideogram must be loaded");IDEO.assert("cyto"==this.getRep().rep,"getOrderedBands: ideogram must be cytogenetic");var c=(this._chromMap[a]||{}).data;if(c){a=[];for(var b=0;b<c.length;b++)"band"===c[b].type&&a.push(c[b].name);
return a}IDEO.reportError("getOrderedBands: no bands for chromosome "+a)}catch(d){console.error("getOrderedBands: "+d)}return null},bandAtBase:function(a,c){if(isNaN(c))return null;var b=this.rep.getBase().start,d=this.rep.getBase().stop,f=this.isLoaded()?this._chromMap[a]:null;if(f&&f.data)for(var f=f.data,h=f.length,e=null;h--;){var g=f[h];if(c>=g[b]){if(c<g[d])return g;if(null!=e&&g[b]<e)break;e=g[b]}}return null},bandAtOffset:function(a,c){var b=this.baseCoordForOffset(a,c);return this.bandAtBase(a,
b)},copyBandAtOffset:function(a,c){var b=this.bandAtOffset(a,c);return b?Oa.apply(b):null},getBandRegion:function(a,c,b,d){var f=Wa.exec(c);if(f){c=this.getRep().getBase();var h=this.getRep().getAux();a=d?a:f[1]||a;if(d=(this._bandMap[a]||{})[f[2]+f[3]])return b.base={chrom:a,start:d[c.start],stop:d[c.stop]},h&&(b.aux={chrom:a,start:d[h.start],stop:d[h.stop]}),!0}return!1},updateLayout:function(a){IDEO.assert(this.container,"Ideogram.updateLayout: ideogram container is not set");this.isReady()&&Z.call(this,
this.container,a)},setAlignment:function(a){IDEO.assert(IDEO.IdeogramAlignment.isValid(a),'Ideogram.setAlignment: invalid alignment value "'+a+'"');IDEO.assert(this.container,"Ideogram.setAlignment: ideogram container is not set");this.align=a;Z.call(this,this.container)},classForEl:function(a){return(a=this._elements[a]||this._proto[a])?a.cls:null},classForElWrap:function(a){return(a=this._elements[a]||this._proto[a])?a.wrapCls:null},setOrientation:function(a){IDEO.assert(IDEO.IdeogramOrientation.isValid(a),
'Invalid orientation value: "'+a+'"');A(a)?this.orientation=IDEO.IdeogramOrientation.Vertical:this.orientation=IDEO.IdeogramOrientation.Horizontal},setColors:function(a){IDEO.assert("object"==typeof a,'Invalid "colors" value - must be an object');this._colors=a},getIdeoCGI:function(){return IDEO.base_path+IDEO.cgi_path+IDEO.ideo_cgi},clearErrors:function(){delete this._errors;for(var a=this.getAllAnnotations(),c=0;c<a.length;c++){var b=a[c];b.clearErrors&&b.clearErrors()}},getErrors:function(){var a=
[];this._errors&&0<this._errors.length&&(a=a.concat(this._errors));for(var c=this.getAllAnnotations(),b=0;b<c.length;b++)a=a.concat(c[b].getErrors());return a},addError:IDEO.addError,addRequestError:function(a){a=new IDEO.RequestError(a);this._errors=this._errors||[];this._errors.push(a);a.log()},isVertical:function(){return A(this.orientation)},isChromLoaded:function(a){return this._chromMap&&this._chromMap[a]},getHighlight:function(){return this.highlight},setHighlight:function(a){null!=a?(IDEO.assert(a instanceof
IDEO.Highlight,"highlight must be an instance of IDEO.Highlight"),this.highlight=a.proxy(),this.shapeList||this.setShapeList(),this.highlight.setIdeogram(this)):delete this.highlight},setShapeList:function(a){null!=a?(IDEO.assert(a instanceof IDEO.ShapeCollection,"shapes must be instance of IDEO.ShapeCollection"),this.shapeList=a):this.shapeList=new IDEO.ShapeCollection},getShapeList:function(){return this.shapeList},setAnnotations:function(a){if(a){this._annotations=[];for(var c=0,b=0;b<a.length;b++){var d=
a[b];if(d&&jQuery.isFunction(d.proxy)){var d=d.proxy(),f=d.isTrack();d.setTrackIndex(f?c++:IDEO.TrackIndex.Overlay);this._annotations.push(d)}else console.error("Invalid annotation object at index "+String(b+1))}}else delete this._annotations},getAnnotations:function(){return this._annotations||[]},setLegends:function(a){a&&a instanceof IDEO.LegendMap?this._legendMap=a:delete this._legendMap},getLegends:function(){return this._legendMap},getAnimationDuration:function(){return this._animationDuration},
setAnimationDuration:function(a){IDEO.assert(!isNaN(a)&&0<a,"Animation duration must be a positive number");this._animationDuration=Number(a)},setSliderTooltip:function(a){this._sliderTooltip=a},getSliderTooltip:function(){return this._sliderTooltip},getServerAlign:function(){return this._serverAlign||this.align},setServerAlign:function(a){this._serverAlign=IDEO.IdeogramAlignment.validatedValue(a)},getChromOrder:function(){return La.apply(this)},chromForAccession:function(a){this._chromAccMap||Ma.apply(this);
return this._chrmAccMap[a]},chromForGI:function(a){this._chromGIMap||Na.apply(this);return this._chrpmGIMap[a]},getChromAccession:function(a){return(this._chromMap[a]||{}).acc},getChromGI:function(a){return(this._chromMap[a]||{}).gi},bodyForComponentElement:function(a){return M(a)},getBodyComponent:function(a){return M(a)},getIdeoComponent:function(a){return pa.call(this,a)},getChromNameForElement:function(a){return(a=this.bodyForComponentElement(a))?a.getAttribute("chrom"):null},setAsync:function(a){null==
a?delete this._async:this._async=!!a},_isAsync:function(){return null==this._async?IDEO.isAsync():this._async},isAsync:function(){return this._isAsync()},setReady:function(a){!this._ready&&a?(this._ready=!0,Ha.apply(this)):this._ready&&!a&&(this._ready=!1,this.clearAllEventHandlers&&this.clearAllEventHandlers())},isReady:function(){return this._ready?!0:!1},toString:function(){return"[object Ideogram:"+this._getId()+"]"},clear:function(){delete this._bandMap;delete this._chromLayout;delete this._chromMap;
delete this._imageURL;delete this.org},setBodyOrder:function(a){var c=this._elements,b="^ideo$|^chrom-label$";null==b&&(b="");if(c)for(var d in c)c.hasOwnProperty(d)&&(b&&(b+="|"),b+="^"+d+"$");IDEO.assert(la(a,new RegExp(b)),'SetOrder: Elements of order must be ideogram element names or equal to "ideo"');this._proto.body.elements=a},getAllAnnotations:function(){var a=this._alts?[this._alts]:[];this._annotations&&(a=a.concat(this._annotations));this.highlight&&(a=a.concat([this.highlight]));return a},
getImageSize:function(){return this._imageSize},getLayerSize:function(a){if(this.layers&&this.layers.root){var c=this.layers.root.sublayers;if(c[a])return a=c[a].frame,{width:a.width,height:a.height}}return null},getIdeoImageSize:function(){return this.getLayerSize(0)},getLegendImageSize:function(){return this.getLayerSize(1)},setImageFormat:function(a){IDEO.assert(sa.test(config[prop]),"Invalid 'fmt' value '"+config[prop]+"'");this.fmt=a},getTimeout:function(){return this._timeout},setTimeout:function(a){IDEO.assert(null==
a||!isNaN(a)&&0<=a);a?this._timeout=a:delete this._timeout},createCoordMapping:function(){if(this.chroms&&this._chromMap&&this.rep.getAux())for(var a=0;a<this.chroms.length;a++){var c=this._chromMap[this.chroms[a]];c&&c.data&&ga(this.rep,c)}},adjust:!0,autoprepare:!0,autodisplay:!0,autofetch:!0,elementOrder:["chrom-label","ideo"],ideogramOrder:["chrom","annot"],align:IDEO.IdeogramAlignment.Default,orientation:IDEO.IdeogramOrientation.Vertical,ideowidth:20,ideoheight:200,_sliderTooltip:"Drag side bar to resize; drag center bar or Alt-drag to move",
_animationDuration:150,_chl:{position:IDEO.LabelPosition.None,color:"#202020",align:IDEO.ChromLabelAlignment.InGroup,fontSize:IDEO.LabelFontSize.Medium,src:"html",css:!0},padding:{annot:10,track:10,alts:5,overlay:0,chrom:0,highlight:0},_showAllLayers:!0,_pseudo:!0,lookupWidth:6,numrows:1,numcols:1,_fontFace:IDEO.FontFace.Helvetica,_fontSize:IDEO.FontSize.Large};var va=/^vert(ical)?$/,fa="fmt dev numrows numcols comment align".split(" "),sa=/^png$|^jpg$|^jpeg$|^tiff$|^svg$|^pdf$|^eps$/,S={body:{tag:"span",
elements:["chrom-label","ideo"],cls:"ideo-body",finish:ha},ideo:{tag:"div",elements:["band-label","chrom","region","annot"],cls:"ideo-container",wrap:"div",wrapCls:"ideo-wrap"},"chrom-label":{tag:"a",cls:"ideo-chrom-label",alias:"label"},"band-label":{tag:"div",wrap:"span",cls:"ideo-band-label",wrapCls:"ideo-band-label-wrap",html:'<span class="ideo-img-wrap"><img class="ideo-img"/></span>',callback:{fn:ka}},chrom:{tag:"div",wrap:"span",cls:"ideo-chrom",wrapCls:"ideo-chrom-wrap",html:'<span class="ideo-img-wrap"><img class="ideo-img"/></span><span class="ideo-hlt-wrap"></span>'},
region:{tag:"div",wrap:"span",cls:"ideo-alt-region",wrapCls:"ideo-alt-wrap",html:'<span class="ideo-img-wrap"><img class="ideo-img"/></span>'},annot:{tag:"div",wrap:"span",cls:"ideo-annot",wrapCls:"ideo-annot-wrap",html:'<span class="ideo-img-wrap"><img class="ideo-img"/></span><span class="ideo-hlt-wrap"></span>'},overlay:{cls:"ideo-overlay"},highlight:{cls:"ideo-highlight"},track:{cls:"ideo-annot"},alts:{cls:"ideo-alt-region",wrapCls:"ideo-alt-wrap"}},ca={body:{tag:"span",elements:["chrom-label",
"ideo"],cls:"ideo-body-r",finish:ha},ideo:{tag:"div",elements:["band-label","chrom","region","annot"],cls:"ideo-container",wrap:"span",wrapCls:"ideo-wrap"},"chrom-label":{tag:"a",cls:"ideo-chrom-label",alias:"label",wrap:"span",wrapCls:"ideo-chrom-label-wrap"},"band-label":{tag:"div",cls:"ideo-band-label-r",html:'<span class="ideo-img-wrap"><img class="ideo-img"/></span>',callback:{fn:ka}},chrom:{tag:"div",cls:"ideo-chrom",html:'<span class="ideo-img-wrap"><img class="ideo-img"/></span><span class="ideo-hlt-wrap"></span>'},
region:{tag:"div",cls:"ideo-alt-region",html:'<span class="ideo-img-wrap"><img class="ideo-img"/></span>'},annot:{tag:"div",cls:"ideo-annot",html:'<span class="ideo-img-wrap"><img class="ideo-img"/></span><span class="ideo-hlt-wrap"></span>'},overlay:{cls:"ideo-overlay"},highlight:{cls:"ideo-highlight"},track:{cls:"ideo-annot"},alts:{cls:"ideo-alt-region",wrapCls:"ideo-alt-wrap"}};ca.label=ca["chrom-label"];S.label=S["chrom-label"];var Va={},X={ideobody:null,ideo:function(a,c,b){if(b&&!b.pseudo){IDEO.assert(b._super,
"No superlayer");var d=a.parentNode,f=Math.floor(b.frame.y-b._super.frame.y),h=Math.ceil(b.frame.y-b._super.frame.y+b.frame.height);this.isVertical()?(jQuery(a).css({top:String(f)+"px",height:String(h-f)+"px"}),jQuery(d).css({height:String(Math.ceil(b._super.frame.height))+"px"})):(jQuery(a).css({left:String(f)+"px",width:String(h-f)+"px"}),jQuery(d).css({width:String(Math.ceil(b._super.frame.height))+"px"}))}c.els.ideo=a},annot:function(a,c,b){IDEO.assert(b,"Missing layer");IDEO.assert(null!=b.index,
"Annotation layer has no index");b.pseudo||K(a,b,this._imageURL,this.orientation,this.padding.annot);a.chrom=c.chrom},chrom:function(a,c,b){IDEO.assert(b,"Missing layer");b.pseudo||K(a,b.highlight||b,this._imageURL,this.orientation);a.chrom=c.chrom;c.els.chrom=a;b.overlay&&(jQuery(a).addClass("ideo-overlay"),b.index=b.overlay.index);b.highlight&&jQuery(a).addClass("ideo-highlight")},region:function(a,c,b){IDEO.assert(b,"Missing layer");b.pseudo||K(a,b,this._imageURL,this.orientation,this.padding.alts);
a.chrom=c.chrom;null!=b.cls&&jQuery(a).addClass(b.cls)},"band-label":function(a,c,b){IDEO.assert(b,"Missing layer");b.pseudo||K(a,b,this._imageURL,this.orientation);a.chrom=c.chrom;null!=b.cls&&jQuery(a).addClass(b.cls)},"chrom-label":function(a,c,b){if("html"==this._chl.src)a.innerHTML=c.chrom;else if("image"==this._chl.src){IDEO.assert(b,"Missing layer");var d=document.createElement("div"),f=document.createElement("img");f.className="ideo-img";jQuery(d).addClass("ideo-img-wrap");d.appendChild(f);
a.appendChild(d);K(d,b,this._imageURL,this.orientation);c.els["chrom-label-wrap"]=d}a.chrom=c.chrom;c.els["chrom-label"]=a}},ja={},Ja={ideobody:["chrom-label","ideo"],ideo:["chrom"]};IDEO.Ideogram.prototype.addPseudoChroms=function(a){for(var c=0;c<a.length;c++){var b=a[c],d={};"string"==typeof b?d.chrom=b:jQuery.extend(d,b);null==this._chromMap[d.chrom]&&(b={},d.layer=na("ideobody",b),b.body=b.ideobody,d.layer.ref=b,d.size=d.size||{bp_length:1},this._chromMap[d.chrom]=d,this.chroms.push(d.chrom))}};
var Wa=/^([^pq]*)([pq])(.*)/,ta={};IDEO.deprecate=function(a,c,b){if(null==ta[a]){var d;null!=b?(d="*** DEPRECATED: method "+b+"."+a+"() is deprecated.",c&&(d+=" Use method "+b+"."+c+"() instead.")):(d="*** Function "+a+"() is deprecated.",c&&(d=" Use function "+c+"() instead."));console.warn(d);ta[a]=!0}};(function(){function a(a){return null!=a?String(a):""}function c(a){return void 0===a?"":null===a?"-1":String(a)}function b(b){return[a(b.id),c(b.fill),c(b.border),a(b.shape),encodeURIComponent(a(b.legend)),
a(b.image)].join(f)}function d(b){return b&&0<b.length?jQuery.map(b,function(b,c){var d;d=null!=b.value?a(b.shapeId)+":"+a(b.op)+":"+encodeURIComponent(a(b.value)):null!=b.from&&null!=b.to?a(b.shapeId)+":"+a(b.op)+":"+encodeURIComponent(a(b.from))+":"+encodeURIComponent(a(b.to)):"";return d}).join(";"):""}IDEO.ShapeCollection=function(a){function b(a,b){return c._validations.hasOwnProperty(b)?c._validations[b](a[b]):!0}var c=this,d=0;this._nextShapeId=function(){return d++};this._id=++IDEO._ideoid;
this.shapes={};if(a){for(var e=c._props.length;e--;){var f=c._props[e];null!=a[f]&&b(a,f)?this[f]=a[f]:a[f]&&console.error('ShapeCollection: Invalid value "'+a[f]+'" for "'+f+'"')}var h=this;null!=a.shapes&&jQuery.isArray(a.shapes)&&jQuery.each(a.shapes,function(a,b){h._addShape(b)})}};IDEO.ShapeCollection.prototype={serialize:function(){var c=a(this.defaultFill)+f+a(this.defaultBorder)+f+a(this.defaultShape)+f+a(this.overlayAlpha)+":",d;if(d=this.shapes){var k=[],l;for(l in d)d.hasOwnProperty(l)&&
k.push(b(d[l]));d=k.join(h)}else d="";return c+d},addShape:function(a){IDEO.assert(null!=a,"shape cannot be null");null==a.id&&(a.id=this._getShapeId());this._addShape(a)},getShapeMap:function(){return this.shapes},copyShapesFrom:function(a){if(null!=a&&a.hasOwnProperty("shapes")){var b=this;jQuery.each(a.shapes,function(a,c){b._addShape(c)})}},toString:function(){return"[object ShapeCollection:"+this._id+"]"},_addShape:function(a){var b=a.id;null==this.shapes[b]?this.shapes[b]=a:console.error('duplicate shape id "'+
b+'", shape ignored')},_getShapeId:function(){var a;do a="uid-"+String(this._nextShapeId());while(this.shapes.hasOwnProperty(a));return a},_validations:{defaultShape:function(a){return IDEO.Shape.isValid(a)},overlayAlpha:function(a){return 0<a&&1>=a}},_props:["defaultFill","defaultBorder","defaultShape","overlayAlpha"]};IDEO.ShapeBinding=function(a){IDEO.assert(a,"ShapeBinding: config argument is required");IDEO.assert(!a.bindings||0==a.bindings.length||a.field,"ShapeBinding: field property is required if bindings are specified");
for(var b in a)switch(b){case "field":this[b]=a[b];break;case "defaultShapeId":this.shapeId=a.defaultShapeId;break;case "bindings":a.bindings&&0<a.bindings.length&&(this.bindings=[],this.addBindings(a.bindings));break;default:console.error('ShapeBinding: invalid config option "'+b+'"')}this._id=++IDEO._ideoid};IDEO.ShapeBinding.prototype={serialize:function(){return a(IDEO.AnnotationColumnMap[this.field]||this.field)+";"+a(this.shapeId)+";"+d(this.bindings)},toString:function(){return"[object ShapeBinding:"+
this._id+"]"},addBindings:function(a){function b(a,b){console.error(this._bindErrorPrefix+String(b+1)+": "+a)}function c(a,c){var d,g;if(null!=a.start||null!=a.stop)d={shapeId:a.shapeId,from:a.start,to:a.stop,op:"range"};if(null==d&&null!=a.from||null!=a.to)d={shapeId:a.shapeId,from:a.from,to:a.to,op:"range"};null==d||null!=d.from&&null!=d.to||(g='both "start" and "stop" must be specified');null==d&&null!=a.value&&(d={shapeId:a.shapeId,value:a.value,op:a.op||"eq"});null!=d&&null==d.shapeId&&(g='"shapeId" is required',
d=null);null==d||null!=d.value||null==d.from&&null==d.to||null!=d.from&&null!=d.to||(g='both "from/to" or "start/stop" should be specified for a range',d=null);g&&b(g,c);return d}for(var d=0;d<a.length;d++){var e=c(a[d],d);e&&this.bindings.push(e)}},_bindErrorPrefix:"Invalid binding at index "};var f=",",h=";"})();(function(){function a(a,b,h){var d=document.createElement(b.tag);h&&(d.layer=h);a.appendChild(d);b.cls&&jQuery(d).addClass(b.cls);if(b.elements)for(a=0;a<b.elements.length;a++){var g=b.elements[a],
f=c[Q(g)];f&&f.call(this,d,this._proto[g],h)}return d}IDEO.LegendMap=function(a){a=a||{};jQuery.extend(!0,this._proto={},b);for(G in a)if(a.hasOwnProperty(G)){var d=aa(G);this[d]&&jQuery.isFunction(this[d])?this[d].call(this,a[G]):console.error('LegendMap: invalid config property "'+G+'"')}};IDEO.LegendMap.prototype={getContainer:function(){return this._container},setContainer:function(a){this._container=a},getTitle:function(){return this._title},setTitle:function(a){this._title=a},getTitlePosition:function(){console.error("LegendMap.getTitlePosition() method is removed");
return"above"},getImageSize:function(){return this._width},setImageSize:function(a){this._width=a},getShapes:function(){return this._shapes},setShapes:function(a){IDEO.assert(a instanceof IDEO.ShapeCollection,"shapes must be a ShapeCollection object");this._shapes=a},getImageURL:function(){return IDEO.ncfetch_url+"?key="+this.nckey},setTitlePosition:function(a){var b=this._proto.body;switch(a){case "above":b.elements=["header","group"];break;case "below":b.elements=["group","header"];break;case "none":b.elements=
["group"];break;default:console.error('invalid legend title position "'+a+'"')}},getShapeSize:function(){return this._size},setNeedsSwap:function(a){this._swap=a},needsSwap:function(){return this._swap},showAll:function(){IDEO.deprecate("showAll","getShowAll","Ideogram");return this.getShowAll()},getShowAll:function(){return!(this._flags&32)},setShowAll:function(a){IDEO.deprecate("setShowAll","setOptions","Ideogram");IDEO.assert("boolean"==typeof a,"option values must be boolean");this._flags=a?this._flags&
-33:this._flags|32},setFlipped:function(a){IDEO.assert("boolean"===typeof a,"setFlipped: argument must be boolean");this._flags=a?this._flags|2:this._flags&-3},isFlipped:function(){return 0!=(this._flags&2)},setFontSize:function(a){IDEO.assert("number"==typeof a,"font size must be a number");this._fontSize=a},getFontSize:function(){return this._fontSize},setNumcols:function(a){IDEO.assert("number"==typeof a&&0<a,"number of columns must be a positive number");this._numCols=a},setNumrows:function(a){IDEO.assert("number"==
typeof a&&0<a,"number of rows must be a positive number");this._numRows=a},getNumcols:function(){return this._numCols},getNumrows:function(){return this._numRows},setColor:function(a){IDEO.assert("string"==typeof a,"color must be a string");this._color=a},setOptions:function(a){for(var b in a)switch(b){case "flipped":IDEO.assert("boolean"==typeof a[b],"option values must be boolean");this._flags=a[b]?this._flags|2:this._flags&-3;break;case "vertical":IDEO.assert("boolean"==typeof a[b],"option values must be boolean");
this._flags=a[b]?this._flags|4:this._flags&-5;break;case "fromTop":IDEO.assert("boolean"==typeof a[b],"option values must be boolean");this._flags=a[b]?this._flags|8:this._flags&-9;break;case "atRight":IDEO.assert("boolean"==typeof a[b],"option values must be boolean");this._flags=a[b]?this._flags|16:this._flags&-17;break;case "showAll":IDEO.assert("boolean"==typeof a[b],"option values must be boolean");this._flags=a[b]?this._flags&-33:this._flags|32;break;default:console.error('Invalid legend option "'+
b+'"')}},display:function(a){a=a||this.getContainer();IDEO.assert(a,"Legends: no container is set");var b=jQuery(a);IDEO.assert(null!=b[0],'Legends: invalid container selector: "'+a+'"');b.html("");(a=c[Q("body")])&&a.call(this,b[0],this._proto.body)},encode:function(){return String(this._width)+"|"+String(this._flags)+"|"+String(this._fontSize)+"|"+String(this._numCols)+"|"+String(this._numRows)+"|"+String(this._color)},selectorForShapeId:function(a){if(a){var b=Ta(this.getContainer());return b?
b+" [sid="+a+"]":"[sid="+a+"]"}return null},selectorForFeat:function(a){return a&&"object"==typeof a?this.selectorForShapeId(a._sid):null},createLegendMap:function(a){function b(a){if("legend-body"==this.type)a[this.id]=this;else for(var c=this.sublayers||[],d=0;d<c.length;d++)c[d]._super=this,b.call(c[d],a)}function c(a){var d=this.sublayers||[];if("legend-group"==this.type){a.push(this);this.ref={};for(var e=0;e<d.length;e++)d[e]._super=this,b.call(d[e],this.ref)}else for(e=0;e<d.length;e++)d[e]._super=
this,c.call(d[e],a)}a&&(this._groupList=[],a.image&&(this.nckey=a.image.nc_key,IDEO.assert(a.layer,"LegendMap: no layer"),a=a.layer.sublayers[1],IDEO.assert(a,"LegendMap: no legend layer"),c.call(a,this._groupList)))},getGroupList:function(){return this._groupList||[]},getLegendMap:function(a){return(a.layer||{}).ref||{}},_setIdeogram:function(a){this._ideo=a},toString:function(){return"[object LegendMap]"},_color:"#202020",_numRows:1,_numCols:1,_flags:33,_fontSize:12,_width:8};var c={createBody:function(a,
b,h){var d=jQuery(a),g=this._ideo.isVertical();this._flags&4&&d.addClass("legend-vertical");this._flags&8&&d.addClass("legend-from-top");g?d.addClass("ideo-vertical"):d.addClass("ideo-horizontal");b.cls&&d.addClass(b.cls);if(b.elements)for(d=0;d<b.elements.length;d++){var g=b.elements[d],f=c[Q(g)];f&&f.call(this,a,this._proto[g],h)}},createGroup:function(b,c,h){h=this.getGroupList();for(var d=this.getNumcols(),g=0,f,l=0;l<h.length;l++)f||(f=a.call(this,b,this._proto.row)),a.call(this,f,c,h[l]),++g>=
d&&(g=0,f=null)},createList:a,createHeader:function(b,c){var d=a.apply(this,arguments),e=this.getTitle();d.innerHTML=null!=e?e:""},createLegends:function(b,c,h){var d=this._ideo.isVertical(),g=h.ref,f;for(f in g)if(g.hasOwnProperty(f)&&g[f].touched){h=g[f];var l=a(b,c),m=jQuery(l);m.addClass(c.cls);l.setAttribute("sid",f);d?m.css({width:String(Math.ceil(h.frame.width))+"px",height:String(Math.ceil(h.frame.height))+"px"}):m.css({height:String(Math.ceil(h.frame.width))+"px",width:String(Math.ceil(h.frame.height))+
"px"});m=document.createElement("span");l.appendChild(m);var v=document.createElement("img");v.src=this.getImageURL();m.appendChild(v);d?jQuery(v).css({left:String(-Math.ceil(h.frame.x))+"px",top:String(-Math.ceil(h.frame.y))+"px"}):jQuery(v).css({top:String(-Math.ceil(h.frame.x))+"px",left:String(-Math.ceil(h.frame.y))+"px"});b.appendChild(l)}}},b={body:{elements:["group"],cls:"legends-body"},row:{tag:"div",cls:"legend-group-row"},group:{tag:"span",elements:["list"],cls:"legend-group"},list:{tag:"ul",
elements:["legends"],cls:"legend-list"},legends:{tag:"li",cls:"legend-row"},header:{tag:"h4",cls:"legend-header"}}})();IDEO.Annotation=function(a){IDEO.assert(null!=a,"Cannot create annotation - config argument must be specified");IDEO.assert(a.url||a.data||a.nckey,"Cannot create Annotation, invalid config");var c=++IDEO._ideoid;this._getId=function(){return c};this._flags=0;this._uploading=!1;for(var b in a)if(a.hasOwnProperty(b))switch(b){case "url":this._source=J.dataWithURL(a.url);break;case "data":IDEO.assert(a.data&&
jQuery.isArray(a.data),"Cannot create Annotation - data must be an array");this._source=new H(a.data);break;case "nckey":this.nckey=a.nckey;break;case "type":this.setType(a.type);break;case "bindings":this.setBindings(a.bindings);break;case "width":this.setWidth(a.width);break;case "flipped":this.setFlipped(a.flipped);break;case "name":this.setName(a.name);break;case "lookupWidth":this[b]=a[b];break;default:console.warn('Annotation: unknown config property "'+b+'", ignored')}};var T=36E5;IDEO.Annotation.prototype=
{upload:function(a){this.clearErrors();this._source&&this._source.upload([this],a)},needsUpload:function(){return!this.failed&&(!this.nckey||this.timestamp&&new Date-this.timestamp>=this._getCacheExpireInterval())},setNeedsUpload:function(){this.nckey=null},isFailed:function(){return this.failed?!0:!1},invalidate:function(){this.nckey=null},setErrorCode:function(a){this._errorCode=a||0},getErrorCode:function(){return this._errorCode},getStatus:function(){switch(this._errorCode){default:return IDEO.AnnotationStatus.OK;
case IDEO.ErrorCode.warning:return IDEO.AnnotationStatus.Warnings;case IDEO.ErrorCode.error:return IDEO.AnnotationStatus.Errors;case IDEO.ErrorCode.failed:return IDEO.AnnotationStatus.Failed}},getData:function(){return this._data},setData:function(a){this._data=a},getOrderedData:function(a){function c(a,b){return a.start-b.start}var b=this.getData()||[],b=jQuery.map(b,function(b,c){return b.chrom===a&&null!=b.start?b:null});try{b.sort(c)}catch(d){console.error(d),b=null}return b},getWidth:function(){return this._width},
setWidth:function(a){null!=a?(IDEO.assert(!isNaN(a)&&0<=a,"invalid 'width', must be a positive number"),this._width=Number(a)):delete this._width},setFlipped:function(a){IDEO.assert("boolean"==typeof a,"invalid 'flipped' value, must be boolean");this._flags=a?this._flags|1:this._flags&-2},isAsync:function(){IDEO.deprecate("isAsync",null,"Annotation");return!1},_getType:function(){return this.type},getType:function(){switch(this.type){case IDEO._AnnotType.Track:return IDEO.AnnotationType.Track;case IDEO._AnnotType.Overlay:return IDEO.AnnotationType.Overlay;
case IDEO._AnnotType.Highlight:return IDEO.AnnotationType.Highlight;default:return"unknown"}},setType:function(a){switch(a){case IDEO.AnnotationType.Track:this.type=IDEO._AnnotType.Track;break;case IDEO.AnnotationType.Overlay:this.type=IDEO._AnnotType.Overlay;break;default:console.error("Invalid annotation type '"+a+"'")}},setName:function(a){a?this._name=a:delete this._name},getName:function(){if(this._name)return this._name;if(this._source.url){var a=this._source.url.split("/");if(a=a[a.length-
1])return a}a=this.getTrackIndex();return null!=a?0>a?"Overlay":"Track#"+String(a+1):null},getSource:function(){return this._source},prepare:function(){var a=this._recMap={},c=this.getData();if(c)try{for(var b=0;b<c.length;b++){var d=c[b];a[d.chrom]||(a[d.chrom]=[]);a[d.chrom].push(d)}var c=function(a,b){return a._off<b._off?-1:a._off>b._off?1:0},f;for(f in a)a.hasOwnProperty(f)&&a[f].sort(c)}catch(h){IDEO.reportError.call(this,h)}},shouldPrepare:function(){return this._shouldPrepare},setShouldPrepare:function(a){this._shouldPrepare=
a},annotationAtOffset:function(a,c){if(this._recMap&&this._recMap[a]){for(var b=this._recMap[a],d=b.length,f=0,h,e;0<d-f;){h=f+Math.floor((d-f)/2);var g=b[h]._off,k=g+b[h]._width;b[h]._width<this.minWidth&&(--g,k+=1);if(g>c)d=h;else if(k<c)f=h+1;else{e=h;break}}if(null!=e)return b[e]}else this._recMap||console.error("Cannot get annotation for coordinate. Method 'prepare' must be called before to enable coordinate conversion.");return null},annotationsInRange:function(a){IDEO.assert(null!=a&&null!=
a.chrom&&!isNaN(a.loc)&&!isNaN(a.length),"Invalid range"+JSON.stringify(a));if(this._recMap&&this._recMap[a.chrom]){for(var c=this._recMap[a.chrom],b=c.length,d=0,f,h;0<b-d;){f=d+Math.floor((b-d)/2);var e=c[f]._off,g=e+c[f]._width;if(e>a.loc)b=f;else if(g<a.loc)d=f+1;else break}for(var k=[],l=Math.floor(a.loc+a.length/2),d=f=Math.max(f-1,0),b=c.length;f<c.length;f++){e=c[f]._off;g=e+c[f]._width;c[f]._width<this.minWidth&&(--e,g+=1);if(e>=a.loc+a.length){b=f;break}g>=a.loc&&(k.push(c[f]),null==h&&
e<=l&&l<g&&(h=f))}k.n0=d;k.n1=b;return 0<k.length?{feats:k,object:c[h]}:null}this._recMap||console.error("Cannot get annotation for coordinate. Method 'prepare' must be called before to enable coordinate conversion.");return null},getBindings:function(){return this._bindings},setBindings:function(a){null==a?delete this.bindings:a instanceof IDEO.ShapeBinding?this._bindings=a:console.error(this,"bindings must be an instance of IDEO.ShapeBinding")},clearErrors:function(){delete this.errors;delete this._errorStatus},
getErrors:function(){return this._errors||[]},addError:IDEO.addError,toString:function(){return"[object Annotation:"+this._getId()+"]"},proxy:function(){var a=Qa.call(this),c=this;a.upload=function(){c.upload(arguments)};return a},isTrack:function(){return this.getType()===IDEO.AnnotationType.TRACK},setTrackIndex:function(a){this._index=a},getTrackIndex:function(){return this._index},isUploading:function(){return this._uploading},setUploading:function(a){if(a)this._uploading=!0;else if(this._uploading){this._uploading=
!1;a=this._observers||[];for(var c=0;c<a.length;c++){var b=a[c];b.observer&&b.fn&&b.fn.call(b.observer,this,b)}delete this._observers}},setFailed:function(a){this.failed=null==a||a},updateAnnot:function(a){a&&a.nc_key?(this.nckey=a.nc_key,this.timestamp=new Date):a&&IDEO.reportError.call(this,a,IDEO.AnnotationStatus.ERRORS,"Annotation")},encode:function(){var a=(this.nckey||"")+U,c,b=this.getBindings();if(b){c=b._index;if(null==c||N[c]!=b)c=V++,N[c]=b;a+=String(c)}a+=U;(c=this._getType())&&(a+=String(c));
a+=U;(c=this.getWidth())&&(a+=String(c));a+=U;this._flags&&(a+=String(this._flags));return a},loadData:function(a){if(a&&a.columns&&0<a.num_rows){var c=a.num_rows;a=this._getColumns(a);this._loadData(a,c);this.shouldPrepare()&&this.prepare()}},_loadData:function(a,c){for(var b=[],d=0;d<c;d++){for(var f={},h=0;h<a.length;h++){var e=a[h].data[d];null!=e&&(f[a[h].name]=e)}b.push(f)}this.setData(b)},_getColumns:function(a){for(var c=[],b=0;b<a.columns.length;b++){var d=a.columns[b],f=d.header.title,f=
ua[f]||f;(d=d.data?d.data.string||d.data["int"]:null)&&c.push({name:f,data:d})}return c},_getCacheExpireInterval:function(){return T},_setCacheExpireInterval:function(a){0<a&&(T=a)},_errorCode:0,minWidth:3,type:IDEO._AnnotType.Track};IDEO.setCacheExpireInterval=function(a){T=a};IDEO.getCacheExpireInterval=function(){return T};var O=IDEO.AnnotationColumnMap,ua={},G;for(G in O)O.hasOwnProperty(G)&&(ua[O[G]]=G);var Pa=function(a,c,b){IDEO.reportError("Annotation upload error",IDEO.AnnotationStatus.ERRORS,
"UploadError")},da=0;IDEO.Annotation.UploadAnnotations=function(a,c,b){for(var d=!1,f={observer:a,fn:function(a,b){window.debug&&(1>=b.cnt?IDEO.reportInfo("+ upload notify: "+a+" -> "+this):IDEO.reportInfo("+ update waiting count: "+String(b.cnt-1)+" for "+this));--b.cnt;0>=b.cnt&&d&&x.apply(this,b.args)},args:[],cnt:0},h=2;h<arguments.length;h++)f.args.push(arguments[h]);var e=0,h=[];da+=1;for(var g=0;g<b.length;g++){var k=b[g];if(k.needsUpload()){if(!k.isUploading()){k.forward(k.clearErrors);var l=
k.getSource();null==l._refid||l._refCnt!=da?(l._refCnt=da,l._refid=++e,h[e]=[k]):h[l._refid].push(k)}if(c||k.isUploading())k.forward(Ra,f),f.cnt++}}for(g=1;g<h.length;g++)if(f=h[g])l=f[0].getSource(),l.upload(f,c);d=!0;for(g=0;g<b.length;g++)if(b[g].isUploading())return!1;return!0};var U=":",V,N;IDEO.Annotation.EncodeAnnotations=function(a,c){var b=[];if(c&&0<c.length){var d=function(a){return jQuery.map(a,function(a,b){return a.serialize()}).join("|")};V=0;N={};for(var f=0;f<c.length;f++){var h=
c[f].encode();b.push(h)}a.annots=b.join(",");0<V&&(N.length=V,a.bindings=d(N))}};H.getDataUploadURL=function(){return IDEO.getCgiDir()+"seqtableuploaddata.cgi?debug=on"};H.SerializeAnnot=function(a){if(!(a&&jQuery.isArray(a)&&0<a.length))return null;for(var c={},b=0,d=0;d<a.length;d++){var f=a[d],h;for(h in f)if(f.hasOwnProperty(h)){var e=O[h]||h;null==c[e]&&(c[e]=b++)}}if(0==b)return null;var g=[],k=[];for(e in c)c.hasOwnProperty(e)&&(k[c[e]]=e);var l=IDEO.Delimiter.Comma;g.push(k.join(l));for(d=
0;d<a.length;d++){k=[];for(f=0;f<b;f++)k[f]="";f=a[d];for(h in f)f.hasOwnProperty(h)&&(e=O[h]||h,k[c[e]]=f[h]);g.push(k.join(l))}return g.join("\n")+"\n"};H.prototype={upload:function(a,c){var b=H.SerializeAnnot(this.data);b?(b={dataType:"json",async:c?!0:!1,type:"POST",contentType:"text/csv",processData:!1,url:H.getDataUploadURL(),data:b},qa(b,a)):(IDEO.reportError("Cannot serialize annotation data"),this.setErrorStatus(IDEO.IdeogramStatus.ERRORS),this.setFailed(!0))},getData:function(){return this.data},
setData:function(a){this.data=a},getURL:function(){return null},toString:function(){return"[object _AnnotationData]"}};(function(){var a={};J.dataWithURL=function(c){var b=a[c];b||(b=a[c]=new J(c));return b};J.getFileUploadURL=function(){return IDEO.getCgiDir()+"seqtableupload.cgi"};J.prototype={upload:function(a,b){var c={dataType:"json",async:b?!0:!1,type:"GET",url:J.getFileUploadURL(),data:{url:this.getURL()}};qa(c,a)},getData:function(){return null},setData:function(a){},getURL:function(){if(/^http:\/\/|^https:\/\/|^ftp:\/\//.test(this.url))return this.url;
if(/^\//.test(this.url)){var a=window.location.host,b=window.location.protocol,d=window.location.port;return b+"//"+a+(d?":"+d:"")+this.url}var a=window.location.host,b=window.location.protocol,f=window.location.pathname,d=window.location.port;if(0<f.length){var h=f.lastIndexOf("/");0<=h&&(f=f.substr(0,h))}return b+"//"+a+(d?":"+d:"")+f+"/"+this.url},toString:function(){return"[object _AnnotationFileData]"}}})();IDEO.Highlight=function(a){IDEO.assert(a&&a.regions,"'regions' property is required in config");
var c=++IDEO._ideoid;this._getId=function(){return c};this._source=new H(a.regions);this.setColor(a.color);this.setLegend(a.legend)};(function(){function a(a){jQuery.extend(this,a||{})}a.prototype=IDEO.Annotation.prototype;IDEO.Highlight.prototype=new a({getColor:function(){return this._color},setColor:function(a){this._color=a||this.defaultColor},getLegend:function(){return this._legend},setLegend:function(a){this._legend=a},setIdeogram:function(a){var b={border:this.getColor(),fill:null,shape:IDEO.Shape.Highlight};
this._legend&&(b.legend=this._legend);a.getShapeList().addShape(b);a=new IDEO.ShapeBinding({defaultShapeId:b.id});this.setBindings(a)},loadData:function(a){},getName:function(){return"Highlight"},toString:function(){return"[object Highlight:"+this._getId()+"]"},defaultColor:"#FFB100",type:IDEO._AnnotType.Highlight,prototype:new a})})();IDEO._Alts=function(a){var c=++IDEO._ideoid;this._getId=function(){return c};this._callbacks={};this.config={fill:"#404060",border:"#202060"};a&&(a.width&&this.setWidth(a.width),
a.callbacks&&jQuery.extend(this._callbacks,a.callbacks),a.tooltipOn&&(this._showInfoOn=a.tooltipOn.toLowerCase()),a.lookupWidth&&(this.lookupWidth=a.lookupWidth),jQuery.extend(this.config,a))};(function(){function a(a){jQuery.extend(this,a)}function c(){try{for(var a=this._data||{},b=0;b<a.length;b++){var c=a[b];jQuery.extend(c,(this._regions[c.chrom]||{})[c.name]||{})}}catch(q){console.error(q)}}function b(a,b,c){c=b.scaffolds;a={};for(var d=0;d<c.length;d++)a[c[d].assm.acc]=a[c[d].assm.acc]||[],
a[c[d].assm.acc].push(c[d]);c="<ul class='alts'>";d=0;for(D in a)if(a.hasOwnProperty(D)){var g=d++%2?" assm-odd":"";c+="<li class='assm"+g+"' acc='"+D+"'><a href='#' target='ideo_alts'>"+D+"</a><span class='alts-comment'>("+a[D][0].assm.name+")</span><ul class=sc-list>";for(var f=0;f<a[D].length;f++){var h=f%2?" sc-odd":"",m=a[D][f];m.sc&&(c+="<li class='refseq"+h+g+"' acc='"+m.sc.acc+"' gi='"+m.sc.gi+"'><span class='header'>RefSeq:</span><a href='#' target='ideo_alts'>"+m.sc.acc+"</a></li>");m.gb&&
(c+="<li class='genbank"+h+g+"' acc='"+m.gb.acc+"' gi='"+m.gb.gi+"'><span class='header'>GenBank:</span><a href='#' target='ideo_alts'>"+m.gb.acc+"</a></li>")}c+="</ul></li>"}c+="</ul>";return"<div><span class='header'>Region:</span><span class='region' region='"+b.name+"'><a href='#' title='Region'>"+b.name+"</a></span></div><div><span class='header'>Range:</span><span class='range'>"+e(b.from)+" - "+e(b.to)+"</span><span class='len'>("+e(b.to-b.from+1)+"bp)</span></div><ul><li><span class='list-header'>Scaffolds</span>"+
c+"</li></ul>"}function d(a,b,c){var d;a=jQuery(a);var g=null!=window.scrollX?window.scrollX:document.documentElement.scrollLeft,e=null!=window.scrollY?window.scrollY:document.documentElement.scrollTop,f=jQuery(window).width(),h=jQuery(window).height(),m=a.outerWidth(),k=a.outerHeight();c?(d=10,c=b.x+g+d,c+m>g+f&&(c=b.x+g-d-m),g=Math.min(e+h-k,Math.max(b.y+e+-20,e))):(d=10,c=Math.min(g+f-m,Math.max(b.x+g+-40,g)),g=b.y+e+d,g+k>e+h&&(g=b.y+e-d-k));a.css({left:c,top:g,visibility:"visible"})}function f(a,
c){var e=c.data,f=e.feats;if(f){g||(g=document.createElement("div"),g.className="ideo-alts-info",document.body.appendChild(g),h(g));g.innerHTML="";var m=e.annot,e=e.chrom;if(m._callbacks&&m._callbacks.prepare)try{var p=m._callbacks.prepare,u=p.fn,v=p.scope||window;p.context&&(p.context.feats=f);u.call(v,a,g,m,f)}catch(z){console.error(z)}else for(var C=0;C<f.length;C++)g.innerHTML+="<div class='region'>"+b(m,f[C],e)+"</div>";if(m._callbacks&&m._callbacks.show)try{p=m._callbacks.show,u=p.fn,v=p.scope||
window,p.context&&(p.context.feats=f),u.call(v,a,g,p.context)}catch(z){console.error(z)}else jQuery("a",g).each(function(a,b){jQuery(b.parentNode).hasClass("refseq")||jQuery(b.parentNode).hasClass("genbank")||b.removeAttribute("href")}).bind("click",function(a){a=a.currentTarget.parentNode;if(jQuery(a).hasClass("refseq")||jQuery(a).hasClass("genbank"))a="https://www.ncbi.nlm.nih.gov/nuccore/"+a.getAttribute("acc"),window.open(a,"ideo_alts");return!1});d(g,{x:c.clientX,y:c.clientY},a.isVertical());
k&&clearTimeout(k)}else k=setTimeout(function(){g&&jQuery(g).css({visibility:""})},l)}function h(a){var b=jQuery(a);b.bind("mouseenter",function(a){k&&clearTimeout(k)}).bind("mouseleave",function(a){k&&clearTimeout(k);k=setTimeout(function(){b.css({visibility:""})},l)})}function e(a){if(null==a)return"";var b=[];a=String(a);var c="",d="",g=a.indexOf(".");0>g?g=a.length:d=a.substr(g);var e=g%3;for(0<e&&(1<e||"-"!=a[0]?b.push(a.substr(0,e)):c=a.substr(0,e));e<g;e+=3)b.push(a.substr(e,3));return c+b.join(",")+
d}a.prototype=IDEO.Annotation.prototype;IDEO._Alts.prototype=new a({needsUpload:function(){return!1},setType:function(){},loadData:function(a){if(a&&a.columns&&0<a.num_rows){var b=a.num_rows;a=this._getColumns(a);this._loadData(a,b);c.apply(this);this.prepare()}},loadRegions:function(a){if(a&&0<a.length){this._regions={};for(var b=0;b<a.length;b++){var c=a[b].assembly_regions;try{if(c&&0<c.length)for(var d=0;d<c.length;d++){var g=c[d];if(g.name&&g.loc&&g.loc.chrom){var e={name:g.name,chrom:g.loc.chrom,
type:g.loc.type};if(g.loc&&g.loc.loc&&g.loc.loc.numeric){var f=g.loc.loc.numeric;f.int_coords?(e.from=f.int_coords.from,e.to=f.int_coords.to):(e.from=f.real_coords.from,e.to=f.real_coords.to)}if(g.scaffolds){e.scaffolds=[];for(var h=0;h<g.scaffolds.length;h++){var m=g.scaffolds[h],k={};m.scaffold_seq&&(k.sc={gi:m.scaffold_seq.gi,acc:m.scaffold_seq.accession});m.genbank_seq&&(k.gb={gi:m.genbank_seq.gi,acc:m.genbank_seq.accession});m.assembly_unit&&(k.assm={name:m.assembly_unit.assembly_unit.name,acc:m.assembly_unit.assembly_unit.accession});
e.scaffolds.push(k)}}var l=this._regions[g.loc.chrom];l||(l=this._regions[g.loc.chrom]={});l[g.name]=e}}}catch(ea){console.error(ea)}}}},setIdeogram:function(a){var b={border:this.config.fill,fill:this.config.border,shape:IDEO.Shape.Rect};this.config.legend&&(b.legend=this.config.legend);a.getShapeList().addShape(b);a=new IDEO.ShapeBinding({defaultShapeId:b.id});this.setBindings(a)},ideoDidDisplay:function(a){if("mouseover"==this._showInfoOn)a.on(IDEO.EventType.AltsAt,f);else if("click"==this._showInfoOn)a.on(IDEO.EventType.AltsClick,
f);else if("contextmenu"==this._showInfoOn)a.on(IDEO.EventType.AltsMenu,f)},setShouldPrepare:function(){},getName:function(){return"Alts"},getRegion:function(a){this._scMap||this.createScaffoldMap();return this._scMap[(a||"").split(".")[0]]},createScaffoldMap:function(){var a={};try{if(this._data)for(var b=0;b<this._data.length;b++)for(var c=this._data[b],d=c.scaffolds||[],g=0;g<d.length;g++){var e=d[g];e.gb&&(a[(e.gb.acc||"").split(".")[0]]=a[e.gb.gi]=c);e.sc&&(a[(e.sc.acc||"").split(".")[0]]=a[e.sc.gi]=
c)}}catch(u){console.error(u)}this._scMap=a},getRegions:function(a){return this._regions},getType:function(){return IDEO.AnnotationType.Alts},toString:function(){return"[object Alts:"+this._getId()+"]"},type:IDEO._AnnotType.Alts,_width:3,prototype:new a});IDEO.Ideogram.prototype.getAltRegion=function(a){return this._alts?this._alts.getRegion(a):null};IDEO.Ideogram.prototype.getAltRegions=function(){return this._alts?this._alts.getRegions():null};IDEO.Ideogram.prototype.getAlts=function(){return this._alts};
var g,k,l=900;IDEO.formatNumber=e})();IDEO.BlastResult=function(a){IDEO.assert(a,"Config must be specified in BlastResult constructor");this.annotsByNCkey={};this.annotsByQueryNum={};this.annotsOrdered=[];this.annotDefaults={};this.rid=null;this.x_SetAnnotationDefaults(a);this.x_SetRID(a.rid);a.hasOwnProperty("combine_query_datasets")&&this.x_SetCombineQueryDatasets(a.combine_query_datasets);this.x_Upload()};IDEO.BlastResult.getDataUploadURL=function(){return IDEO.getCgiDir()+"seqtableblast.cgi?debug=on"};
IDEO.BlastResult.COMBINED_QRY_NUM="combined";IDEO.BlastResult.MAX_QUERY_COUNT=200;IDEO.BlastResult.prototype={addError:IDEO.addError,getAnnotByQueryNum:function(a){null==a&&(a=IDEO.BlastResult.COMBINED_QRY_NUM);return this.x_HasQueryNum(a)?this.annotsByQueryNum[a]:null},getAnnotations:function(){return this.annotsOrdered},setRID:function(a){this.x_SetRID(a)&&null!=this.rid&&(this.x_Clear(),this.x_Upload())},x_HasCombinedQryDset:function(){return this.x_HasQueryNum(IDEO.BlastResult.COMBINED_QRY_NUM)},
x_HasQueryNum:function(a){return this.annotsByQueryNum.hasOwnProperty(a)},x_SetCombineQueryDatasets:function(a){this.combineQryDsets=a},x_Clear:function(){this.annotsByNCkey={};this.annotsByQueryNum={};this.annotsOrdered=[]},x_SetRID:function(a){var c=!1;null==a||5>a.length?(this.rid=null,c=!0):a!=this.rid&&(this.rid=a,c=!0);return c},x_AjaxSuccess:function(a,c,b){if(a.queries){var d=[];jQuery.each(a.queries,function(a,b){d[b.query_number||IDEO.BlastResult.COMBINED_QRY_NUM]=b});for(var f in d)a=d[f],
null!=a&&(c=this.x_CreateAnnot(a.nc_key),this.annotsByNCkey[a.nc_key]=c,this.annotsByQueryNum[f]=c);if(this.x_HasCombinedQryDset())this.annotsOrdered.push(this.annotsByQueryNum[IDEO.BlastResult.COMBINED_QRY_NUM]);else for(f=1;f<IDEO.BlastResult.MAX_QUERY_COUNT;f++)if(this.x_HasQueryNum(f))this.annotsOrdered.push(this.annotsByQueryNum[f]);else break}},x_Upload:function(){if(null!=this.rid){var a=this,c={dataType:"json",async:!1,type:"POST",processData:!1,url:IDEO.BlastResult.getDataUploadURL(),data:this.x_GetAjaxParams(),
success:function(b,c,f){a.x_AjaxSuccess(b,c,f)},error:function(a,c,f){IDEO.reportError.call(this,data,IDEO.AnnotationStatus.ERRORS,"BlastResult")}};jQuery.ajax(c)}},x_GetAjaxParams:function(){return["rid="+this.rid,"qds="+(this.combineQryDsets?"combined":"separate")].join("&")},x_SetAnnotationDefaults:function(a){a.hasOwnProperty("bindings")&&(this.annotDefaults.bindings=a.bindings);a.hasOwnProperty("width")&&(this.annotDefaults.width=a.width)},x_CreateAnnot:function(a){a=jQuery.extend({},this.annotDefaults,
{nckey:a});return new IDEO.Annotation(a)}};IDEO.BlastShapeCollection={Config:{defaultFill:"#4000FF",defaultShape:IDEO.Shape.Rect,defaultBorder:"#000000",shapes:[{fill:"222222",border:"222222",id:"blst_unscored",legend:"unscored"},{fill:"000000",border:"000000",id:"blst_under40",legend:"under 40"},{fill:"0000FF",border:"0000FF",id:"blst_40to50",legend:"40-50"},{fill:"00FF00",border:"00FF00",id:"blst_50to80",legend:"50-80"},{fill:"FF00FF",border:"FF00FF",id:"blst_80to200",legend:"80-200"},{fill:"FF0000",
border:"FF0000",id:"blst_over200",legend:"over 200"}]}};IDEO.BlastScoreBindings=new IDEO.ShapeBinding({defaultShapeId:"blst_unscored",field:"SCORE",bindings:[{shapeId:"blst_under40",start:0,stop:40},{shapeId:"blst_40to50",start:41,stop:50},{shapeId:"blst_50to80",start:51,stop:80},{shapeId:"blst_80to200",start:81,stop:200},{shapeId:"blst_over200",start:201,stop:1E3}]});(function(){function a(a){var b=a.data.ideo;if(b._eventsSuspended)return!0;var c=pa.call(b,a.target),d=M(c),g=c.chrom,e=b._chromMap[g]||
{},f=e.acc,h=e.gi,m=b.classForEl("chrom"),q=b.classForEl("annot"),W=b.classForEl("overlay"),k=b.classForEl("alts"),l=c.getBoundingClientRect(),n=a.clientX,p=a.clientY,r=c.layer.type,r=b.padding[r]||0,l=b.isVertical()?p-l.top-r:n-l.left-r,n=b.auxCoordForOffset(g,l),p=b.baseCoordForOffset(g,l);if("click"===a.type){jQuery(c).hasClass(m)&&(r=b.bandAtOffset(g,l))&&(a.ideotype=t.BandClick,jQuery.extend(a.data,{chrom:g,acc:f,gi:h,band:r,base:p,aux:n,offset:l}),E(b,t.BandClick,a));if(jQuery(c).hasClass(q)||
jQuery(c).hasClass(W)||jQuery(c).hasClass(k))if(r=c.layer.index,c=b.getAllAnnotations()[r],r=c.getType(),q=c.lookupWidth||b.lookupWidth,e={chrom:g,loc:l+e.spec.baseScale*e.spec.start-q/2,length:q},e=c.annotationsInRange(e)||{},q=e.object){switch(r){default:a.ideotype=t.AnnotClick;break;case "alts":a.ideotype=t.AltsClick}jQuery.extend(a.data,{feats:e.feats,feat:q,chrom:g,acc:f,gi:h,annot:c,base:p,aux:n,offset:l});E(b,a.ideotype,a)}d.focus()}else if("contextmenu"===a.type&&(jQuery(c).hasClass(m)&&(r=
b.bandAtOffset(g,l))&&(a.ideotype=t.BandMenu,jQuery.extend(a.data,{chrom:g,acc:f,gi:chrpmGI,band:r,base:p,aux:n,offset:l}),E(b,t.BandMenu,a)),jQuery(c).hasClass(q)||jQuery(c).hasClass(W)||jQuery(c).hasClass(k))&&(r=c.layer.index,c=b.getAllAnnotations()[r],r=c.getType(),q=c.lookupWidth||b.lookupWidth,e={chrom:g,loc:l+e.spec.baseScale*e.spec.start-q/2,length:q},e=c.annotationsInRange(e)||{},q=e.object)){switch(r){default:a.ideotype=t.AnnotMenu;break;case "alts":a.ideotype=t.AltsMenu}jQuery.extend(a.data,
{feats:e.feats,feat:q,chrom:g,acc:f,gi:h,annot:c,base:p,aux:n,offset:l});E(b,a.ideotype,a)}return!1}function c(a){var b=a.data.ideo;if(b._eventsSuspended)return!0;var c=jQuery(a.currentTarget.parentNode).attr("chrom");a.ideotype="focus";jQuery.extend(a.data,{chrom:c});E(b,"focus",a)}function b(a){var b=a.data.ideo;if(b._eventsSuspended)return!0;var c=jQuery(a.currentTarget.parentNode).attr("chrom");a.ideotype="blur";jQuery.extend(a.data,{chrom:c});E(b,"blur",a)}function d(a){var b=a.data.ideo;if(b._eventsSuspended)return!0;
var c=a.currentTarget;M(c);var d=c.chrom,g=b._chromMap[d]||{},e=g.acc,g=g.gi,h=c.getBoundingClientRect(),m=a.clientX,q=a.clientY,h=b.isVertical()?q-h.top:m-h.left,m=b.auxCoordForOffset(d,h),q=b.baseCoordForOffset(d,h),k=b.bandAtOffset(d,h);if(k){var l;k.arm?(l=d+"."+k.arm,k.band&&(l+="."+k.band)):(null==k._uid&&(k._uid=++w),l="uid-"+k.type+"-"+String(k._uid));l!=a.data.bandId&&(a.ideotype=t.BandOver,jQuery.extend(a.data,{chrom:d,acc:e,gi:g,band:k,bandId:l,base:q,aux:m,offset:h}),E(b,t.BandOver,a),
(a=b._state[t.BandClick])&&0<a.length&&jQuery(c).css({cursor:"pointer"}))}else f(a);return!1}function f(a){var b=a.data.ideo;if(b._eventsSuspended)return!0;a.data.bandId&&(delete a.data.bandId,a.ideotype=t.BandOut,IDEO.debugLog.call(b,"ideo: ->band out"),E(b,t.BandOut,a));jQuery(a.currentTarget).css({cursor:""});return!1}function h(a){var b=a.data.ideo;if(b._eventsSuspended)return!0;var c=a.currentTarget;M(c);var d=c.chrom,g=b._chromMap[d]||{},e=g.acc,f=g.gi,h=c.getBoundingClientRect(),m=c.layer.index,
m=b.getAllAnnotations()[m],q=m.getType(),l=b.padding[q]||0,n=a.clientX,p=a.clientY,h=b.isVertical()?p-h.top-l:n-h.left-l,l=m.lookupWidth||b.lookupWidth;if(g=m.annotationsInRange({chrom:d,loc:h+g.spec.baseScale*g.spec.start-l/2,length:l})){l=g.object;n=a.data.feats||[];if(g.feats.n0!=n.n0||g.feats.n1!=n.n1||g.chrom!=a.data.chrom){IDEO.debugLog("ideo: ->annot at: "+h);var p=b.auxCoordForOffset(d,h),r=b.baseCoordForOffset(d,h);jQuery.extend(a.data,{feats:g.feats,chrom:d,acc:e,gi:f,annot:m,base:r,aux:p});
switch(q){default:a.ideotype=t.AnnotAt;break;case "alts":a.ideotype=t.AltsAt}E(b,a.ideotype,a)}if(l&&l!=a.data.feat){IDEO.debugLog("ideo: ->annot over "+Sa(l));a.ideotype=t.AnnotOver;p=b.auxCoordForOffset(d,h);r=b.baseCoordForOffset(d,h);jQuery.extend(a.data,{feat:l,feats:n,chrom:d,acc:e,gi:f,annot:m,base:r,aux:p});switch(q){default:a.ideotype=t.AnnotOver;break;case "alts":a.ideotype=t.AltsOver}E(b,a.ideotype,a);a=b._state[t.AnnotClick];b=b._state[t.AltsClick];(a&&0<a.length||b&&0<b.length)&&jQuery(c).css({cursor:"pointer"})}else null==
l&&a.data.feat&&k(b,a,!1)}else k(b,a,!0);return!1}function e(a,b){null==b.right&&(b.right=b.left+b.width);null==b.bottom&&(b.bottom=b.top+b.height);return a.x>=b.left&&a.y>=b.top&&a.x<b.right&&a.y<b.bottom}function g(a){var b=a.data.ideo;if(b._eventsSuspended)return!0;var c;a:{c={x:a.clientX,y:a.clientY};var d=a.currentTarget,g=d.getBoundingClientRect(),f=e(c,g);if(!f&&d.childNodes)for(var m=0;m<d.childNodes.length;m++)if(g=d.childNodes[m],1===g.nodeType&&(g=g.getBoundingClientRect(),e(c,g))){c=!0;
break a}c=f}if(c)return h(a);k(b,a,!0);return!1}function k(a,b,c){var d=b.currentTarget,d=d.layer.index,d=a.getAllAnnotations()[d].getType();if(c&&b.data.feats){delete b.data.feats;switch(d){default:b.ideotype=t.AnnotAt;break;case "alts":b.ideotype=t.AltsAt}IDEO.debugLog.call(a,"ideo: ->annot at (out)");E(a,b.ideotype,b)}if(b.data.feat){delete b.data.feat;switch(d){default:b.ideotype=t.AnnotOut;break;case "alts":b.ideotype=t.AltsOut}IDEO.debugLog.call(a,"ideo: ->annot out");E(a,b.ideotype,b)}d=b.currentTarget;
jQuery(d).css({cursor:""})}function l(){if(!this._state.clickHandlerSet){var d=this.selectorForElement("ideo"),g={ideo:this};jQuery(d).bind("click",g,a).bind("focus",g,c).bind("blur",g,b).bind("contextmenu",g,a);this._state.clickHandlerSet=!0}}function m(){if(!this._state.bandHandlersSet){var a=this.selectorForElement("chrom"),b={ideo:this};jQuery(a).bind("mouseover",b,d).bind("mousemove",b,d).bind("mouseout",b,f);this._state.bandHandlersSet=!0}}function v(){if(!this._state.annotHandlersSet){var a=
this.selectorForElement("annot,overlay"),b={ideo:this};jQuery(a).bind("mouseover",b,h).bind("mousemove",b,h).bind("mouseout",b,g);this._state.annotHandlersSet=!0}}function r(){if(!this._state.altsHandlersSet){var a=this.selectorForElement("alts"),b={ideo:this};jQuery(a).bind("mouseover",b,h).bind("mousemove",b,h).bind("mouseout",b,g);this._state.altsHandlersSet=!0}}function q(a,b,c,d,g){this._invocationsRunning||Ga.apply(this,[IDEO.Ideogram.prototype.on,a,b,c,d]);if(this.isReady())switch(R.call(this,
a,b,c,d,g),a){case t.BandOver:case t.BandOut:m.apply(this);break;case t.AnnotOver:case t.AnnotOut:case t.AnnotAt:v.apply(this);break;case t.BandMenu:case t.BandClick:l.apply(this);m.apply(this);break;case t.AnnotMenu:case t.AnnotClick:l.apply(this);v.apply(this);break;case t.AltsClick:case t.AltsMenu:l.apply(this);r.apply(this);break;case t.AltsOver:case t.AltsOut:case t.AltsAt:r.apply(this)}}function n(a){var b=a.data.ideo;if(b._eventsSuspended)return!0;var c=jQuery(a.target.parentNode).attr("chrom");
if("keypress"===a.type){if(9===a.keyCode||a.metaKey||a.ctrlKey)return!0;for(var d=b._state.keyPress||[],g=0;g<d.length;g++)try{var e=d[g];e.fn.apply(e.scope||window,[b,e.ctxt,{chrom:c},a])}catch(Xa){console.error(Xa)}}else"focus"===a.type?IDEO.debugLog.call(b,"+ focus"):"blur"===a.type&&IDEO.debugLog.call(b,"+ blur");return!1}function p(a){var b=[];if(a){for(var c in a)a.hasOwnProperty(c)&&b.push(c);b.sort(function(a,b){return a<b?-1:a>b?1:0})}return b}function u(a){x||(x=document.createElement("div"),
jQuery(x).addClass("band-highlight"),document.body.appendChild(x),y=ba(x));var b=null!=window.scrollX?window.scrollX:document.documentElement.scrollLeft,c=null!=window.scrollY?window.scrollY:document.documentElement.scrollTop;jQuery(x).animate({left:String(Math.round(a.x+b-y.left))+"px",top:String(Math.round(a.y+c-y.top))+"px",width:String(Math.round(a.width))+"px",height:String(Math.round(a.height))+"px"},this.getAnimationDuration());jQuery(x).css({visibility:"visible"})}function B(a,b){this._state=
this._state||{};this._state.bandNames=this._state.bandNames||{};this._state.bandNames[a]||(this._state.bandNames[a]=p(this._bandMap[a]));this._state.lit&&this._state.lit.chrom!=a&&delete this._state.lit;a&&b&&((this._state.lit=this._state.lit||{chrom:a}).bandId=b);return b}function C(a){this._state=this._state||{};this._state.bandNames=this._state.bandNames||{};var b=this._state.bandNames[a];b||(b=this._state.bandNames[a]=p(this._bandMap[a]));this._state.lit&&this._state.lit.chrom!=a&&delete this._state.lit;
if(0<b.length){a=this._state.lit=this._state.lit||{chrom:a};var c=0;if(a.bandId){for(c=b.length;0<c--&&b[c]!=a.bandId;);c+=1}c>=b.length&&(c=0);a.bandId=b[c];return b[c]}return null}function z(a){this._state=this._state||{};this._state.bandNames=this._state.bandNames||{};var b=this._state.bandNames[a];b||(b=this._state.bandNames[a]=p(this._bandMap[a]));this._state.lit&&this._state.lit.chrom!=a&&delete this._state.lit;if(0<b.length){a=this._state.lit=this._state.lit||{chrom:a};var c=0;if(a.bandId){for(c=
b.length;0<c--&&b[c]!=a.bandId;);--c}0>c&&(c=b.length-1);a.bandId=b[c];return b[c]}return null}var t=IDEO.EventType,w=0;IDEO.Ideogram.prototype.selectorForElement=function(a,b){IDEO.assert("string"==typeof this.container,"Ideogram container must be a string");var c=[],d,g;if(this.container)for(var e=a.split(","),f=0;f<e.length;f++){var h=this.container;if(d=this.classForEl(e[f]))"body"==e[f]?(h+=" ."+(g=d),b&&(h+='[chrom="'+b+'"]')):(b&&(g||(g=this.classForEl("body")),h+=" ."+g+'[chrom="'+b+'"]'),
h+=" ."+d),c.push(h)}return 0<c.length?c.join(","):null};IDEO.Ideogram.prototype.onFocus=function(a,b,c,d){R.call(this,"focus",a,b,c,d);l.apply(this)};IDEO.Ideogram.prototype.onBlur=function(a,b,c,d){R.call(this,"blur",a,b,c,d);l.apply(this)};IDEO.Ideogram.prototype.on=function(a,b,c,d,g){IDEO.assert(t.isValid(a),'Invalid event type "'+a+'"');q.apply(this,arguments)};IDEO.Ideogram.prototype.resetAllHandlers=function(){if(this._state&&this._state.clickHandlerSet){var e=this.selectorForElement("ideo");
jQuery(e).unbind("click",a).unbind("focus",c).unbind("blur",b).unbind("contextmenu",a);this._state.clickHandlerSet=!1}this._state&&this._state.bandHandlersSet&&(e=this.selectorForElement("chrom"),jQuery(e).unbind("mouseover",d).unbind("mousemove",d).unbind("mouseout",f),this._state.bandHandlersSet=!1);this._state&&this._state.annotHandlersSet&&(e=this.selectorForElement("annot,overlay"),jQuery(e).unbind("mouseover",h).unbind("mousemove",h).unbind("mouseout",g),this._state.annotHandlersSet=!1);this._state&&
this._state.altsHandlersSet&&(e=this.selectorForElement("alts"),jQuery(e).unbind("mouseover",h).unbind("mousemove",h).unbind("mouseout",g),this._state.altsHandlersSet=!1)};IDEO.Ideogram.prototype.clearAllEventHandlers=function(){if(this._state){var a=[],b;for(b in this._state)this._state.hasOwnProperty(b)&&a.push(b);for(b=0;b<a.length;b++)delete this._state[a[b]]}this.resetAllHandlers()};IDEO.Ideogram.prototype._registerKeyPressHandlers=function(){if(!this._state.keyPressHandlersSet){var a=this.classForEl("ideo"),
b={ideo:this};jQuery(this.container+" ."+a).bind("keypress",b,n).bind("focus",b,n).bind("blur",b,n);this._state.keyPressHandlersSet=!0}};IDEO.Ideogram.prototype.onKeyPress=function(a,b,c){R.call(this,"keyPress",a,c,b);this._registerKeyPressHandlers()};IDEO.Ideogram.prototype.nextChrom=function(a){for(var b=0;b<this.chroms.length;b++)if(this.chroms[b]==a)return++b>=this.chroms.length&&(b=0),this.chroms[b];return null};IDEO.Ideogram.prototype.previousChrom=function(a){for(var b=0;b<this.chroms.length;b++)if(this.chroms[b]==
a)return 0>--b&&(b=this.chroms.length-1),this.chroms[b];return null};IDEO.Ideogram.prototype.focusChrom=function(a){var b=this.classForEl("ideo");jQuery(this.container+' [chrom="'+a+'"] .'+b)[0].focus()};IDEO.Ideogram.prototype._updateState=function(){this._state&&(this._state.annotHandlesSet&&(this._state.annotHandlesSet=!1,v.apply(this)),this._state.bandHandlersSet&&(this._state.bandHandlersSet=!1,m.apply(this)))};IDEO.Ideogram.prototype.getBandWithName=function(a,b){return this._bandMap&&this._bandMap[a]?
this._bandMap[a][b]:null};IDEO.Ideogram.prototype.getBandRect=function(a,b){var c=this.getRep().getIscn(),d=c?(this._bandMap[a]||{})[b]:null;if(d){var g=this.offsetForBaseCoord(a,d[c.start]),c=this.offsetForBaseCoord(a,d[c.stop]),d=jQuery(this.container+" [chrom="+a+"] .ideo-chrom")[0].getBoundingClientRect(),d={x:d.left,y:d.top,width:d.right-d.left,height:d.bottom-d.top};this.isVertical()?(d.y+=g,d.height=c-g):(d.x+=g,d.width=c-g);return d}return null};IDEO.Ideogram.getBandName=function(a){return a?
a.name:null};var x,y;IDEO.Ideogram.prototype.highlightBand=function(a,b){IDEO.assert(this.isReady(),"Ideogram is not ready");B.apply(this,arguments);if(a&&b){var c=this.getBandRect(a,b);if(c)return u.apply(this,[c]),!0}else x&&jQuery(x).css({visibility:""});return!1};IDEO.Ideogram.prototype.highlightNextBand=function(a){var b=C.apply(this,arguments);return a&&b&&(b=this.getBandRect(a,b))?(u.apply(ideo,[b]),!0):!1};IDEO.Ideogram.prototype.highlightPreviousBand=function(a){var b=z.apply(this,arguments);
return a&&b&&(b=this.getBandRect(a,b))?(u.apply(ideo,[b]),!0):!1};IDEO.Ideogram.prototype.suspendEvents=function(){this._eventsSuspended=!0};IDEO.Ideogram.prototype.resumeEvents=function(){this._eventsSuspended=!1}})();(function(){function a(a){c.call(a.data.ideo,a);a.stopPropagation();return!1}function c(a){try{var b=jQuery(this.container),c=a.currentTarget,e=a.data.mask,f=c.chrom,h=a.data.info,r=h.x=a.clientX,q=r-h.chromBounds.x,n=this._sel[f],p=c.getBoundingClientRect(),u=h.bounds={x:p.left+h.leftBorder,
y:p.top,width:p.right-p.left-h.leftBorder-h.rightBorder,height:p.bottom-p.top},B=n.dragCoord,C="aux"==B?this.offsetForAuxCoord:this.offsetForBaseCoord;h.left=C.call(this,f,n[B].start);h.width=Math.max(1,C.call(this,f,n[B].start+n[B].length)-h.left);a.altKey?(h.mode="center",b.css({cursor:"move"})):r<u.x?(h.mode="left",b.css({cursor:"w-resize"})):r>u.x+u.width?(h.mode="right",b.css({cursor:"e-resize"})):(h.mode="center",b.css({cursor:"move"}));n.base.t=(this.baseCoordForOffset(f,q)-n.base.start)/n.base.length;
n.aux&&(n.aux.t=(this.auxCoordForOffset(f,q)-n.aux.start)/n.aux.length);jQuery(document).on("mouseup",{ideo:this,info:h,mask:e},d).on("mousemove",{ideo:this,info:h,mask:e},d);jQuery(e).css({display:"block"});var z=GB.Util._getProp(e,"z-index");jQuery(c).css({"z-index":z+1})}catch(t){console.error(t),this._sel&&delete this._sel.state}}function b(a){var b=a.data.info;try{var c=b.chrom,e=this._sel[c],f={region:{chrom:c,coord:e.dragCoord}};"aux"==e.dragCoord?f.region.aux={start:e.aux.start,length:e.aux.length,
chromLength:e.aux.chromLength}:f.region.base={start:e.base.start,length:e.base.length,chromLength:e.base.chromLength};f.region.dragMode=b.mode;jQuery(this.container).trigger("regionchange",{data:f,ideo:this});jQuery(document).off("mouseup",d).off("mousemove",d)}catch(v){console.error(v)}jQuery(a.data.mask).css({display:""});jQuery(b.slider).css({"z-index":""});jQuery(this.container).css({cursor:""});return!1}function d(a){f.call(a.data.ideo,a);"mouseup"==a.type&&b.call(a.data.ideo,a);a.stopPropagation();
return!1}function f(a){var b=a.data.info,c=b.slider,d=b.chrom,e=this._sel[d],f=a.clientX;a.stopPropagation();if(f!==b.x)try{var h=e.dragCoord;switch(b.mode){case "center":f<b.chromBounds.x+b.chromOffset&&(f=b.chromBounds.x+b.chromOffset);f>b.chromBounds.x+b.chromBounds.width&&(f=b.chromBounds.x+b.chromBounds.width);var q=f-b.chromBounds.x,n=("aux"===h?this.auxCoordForOffset(d,q):this.baseCoordForOffset(d,q))-e[h].t*e[h].length,p,u,B;n<e[h].chromStart&&(n=e[h].chromStart);p=n+e[h].length;p>e[h].chromStop&&
(p=e[h].chromStop,n=Math.max(e[h].chromStart,p-e[h].length));e[h].start=n;e[h].length=p-n;"aux"===h?(u=this.offsetForAuxCoord(d,n),B=this.offsetForAuxCoord(d,p)):(u=this.offsetForBaseCoord(d,n),B=this.offsetForBaseCoord(d,p));B<u+1&&(B=u+1);jQuery(c).css({left:String(u-b.leftBorder)+"px",width:String(B-u)+"px"});b.left=u;b.width=B-u;break;case "left":var C=f-b.x,z=b.width-C;1>z&&(C=b.width-1,z=1,f=b.x+C);0>(b.left+=C)&&(z+=b.left,b.left=0);b.width=z;jQuery(c).css({left:String(b.left-b.leftBorder)+
"px",width:String(b.width)+"px"});p=e[h].start+e[h].length;e[h].start="aux"===h?this.auxCoordForOffset(d,b.left):this.baseCoordForOffset(d,b.left);e[h].length=p-e[h].start;break;case "right":var t=f-b.x;b.left+b.width+t>b.chromBounds.width&&(t=b.chromBounds.width-(b.left+b.width),f=b.x+t);z=b.width+t;1>z&&(z=1,f=b.x+z-b.width);b.width=z;jQuery(c).css({width:String(z)+"px"});p="aux"===h?this.auxCoordForOffset(d,b.left+b.width):this.baseCoordForOffset(d,b.left+b.width);e[h].length=p-e[h].start;0>=e[h].length&&
(console.error("Selection: negative length"),e[h].length=50)}b.x=f}catch(ea){console.error(ea)}}IDEO.Ideogram.prototype.getChromLength=function(a,b){var c=Ua.apply(this,[a]),d=L(b||"base"),e=this.getRep();return jQuery.isFunction(e[d])?(d=e[d].apply(e))?c[d.name]:null:null};IDEO.Ideogram.prototype.getChromRange=function(a,b){var c=ra.apply(this,[a]),d=L(b||"base"),e=this.getRep();return jQuery.isFunction(e[d])?(d=e[d].apply(e))?c[d.name]:null:null};IDEO.Ideogram.prototype.chromSeqLength=function(a){var b=
this._chromMap[a],c=this.getRep().getSeq();if(b&&c&&b.size)return b.size[c.length]||1;b||console.error("Chromosome "+a+" is not available");c||console.error("Sequence coordinates are not available");return 1};IDEO.Ideogram.prototype.setRegionRange=function(a,b){if(!this.isReady())return!1;var c=this.selectorForElement("chrom",a),c=jQuery(c)[0],d=jQuery(".slider",c)[0];if(!d)return!1;var e=this._sel[a],g=this._chromMap[a],f=d.info,h=!0,n,p;if(b)if(null!=b.start&&null!=b.stop){if(isNaN(b.start)||isNaN(b.stop))throw Error("Invalid range - NaN");
"seq"==e.baseType?(e.base.start=Math.min(g.size.bp_chr_stop,Math.max(1,g.size.bp_chr_start,b.start)),e.base.stop=Math.max(1,g.size.bp_chr_start,Math.min(g.size.bp_chr_stop,b.stop)),e.base.length=e.base.stop-e.base.start+1,n=this.offsetForBaseCoord(a,e.base.start),p=this.offsetForBaseCoord(a,e.base.stop+1),e.aux&&(e.aux.start=this.convertBaseToAux(a,e.base.start),e.aux.stop=this.convertBaseToAux(a,e.base.stop),e.aux.length=e.aux.stop-e.aux.start)):e.aux&&"seq"==e.auxType?(e.aux.start=Math.min(g.size.bp_chr_stop,
Math.max(1,g.size.bp_chr_start,b.start)),e.aux.stop=Math.max(1,g.size.bp_chr_start,Math.min(g.size.bp_chr_stop,b.stop)),e.aux.length=e.aux.stop-e.aux.start+1,n=this.offsetForAuxCoord(a,e.aux.start),p=this.offsetForAuxCoord(a,e.aux.stop+1),e.base.start=this.convertAuxToBase(a,e.aux.start),e.base.stop=this.convertAuxToBase(a,e.aux.stop+1),e.base.length=e.base.stop-e.base.start):(console.error("selectRegion: range type not supported - only cyto coord is available in representation"),h=!1)}else console.error("selectRegion: invalid range"),
h=!1;if(h){e.x=n;e.width=p-n;1>e.width&&(e.width=1);n={left:n-d.info.leftBorder,top:-d.info.offsetTop-d.info.topBorder-2*d.info.chromHeight,width:Math.min(e.width,d.info.chromBounds.width),height:d.info.offsetHeight};p={display:"",left:String(n.left)+"px",top:String(n.top)+"px",width:String(n.width)+"px",height:String(n.height)+"px"};if("function"==typeof f.styleCallback)try{f.styleCallback(this,d,{style:p,bounds:n,chrom:a,ideoEl:c})}catch(u){console.error(u)}jQuery(d).css(p)}return h};IDEO.Ideogram.prototype._sliderOffset=
5;var h=/^base$|^aux$|^iscn$|^cyto$|^seq$|^nonseq$/;IDEO.Ideogram.prototype.selectRegion=function(b,c,d){if(this.isReady()){var e=this.selectorForElement("chrom",b);if(e=jQuery(e)[0]){var g=jQuery(".slider",e)[0],f=GB.Util.getClearMask();if(!g){var k=document.createElement("div");k.className="slider";k.chrom=b;e.appendChild(k);g=document.createElement("span");g.className="left-bar";k.appendChild(g);g=document.createElement("span");g.className="middle-bar";k.appendChild(g);g=document.createElement("span");
g.className="right-bar";k.appendChild(g);var g=k,k=e.getBoundingClientRect(),k={x:k.left,y:k.top,width:k.right-k.left,height:k.bottom-k.top},q=ba(g),n=this.getSliderTooltip(),k=g.info={chrom:b,chromBounds:k,chromOffset:0,leftBorder:q.left,rightBorder:q.right,topBorder:q.top,slider:g};n&&(g.title=n);jQuery(g).on("mousedown",{ideo:this,mask:f,info:k},a)}this._sel=this._sel||{};f=this._sel[b]={baseType:this.getRep().getBase().type,base:{}};if(g=this.getRep().getAux())f.auxType=g.type,f.aux={};n=ra.call(this,
b);f.base.chromLength=n.base.length;f.base.chromStart=n.base.start;f.base.chromStop=n.base.stop;g&&(f.aux.chromLength=n.aux.length,f.aux.chromStart=n.aux.start,f.aux.chromStop=n.aux.stop);k.offsetTop=this._sliderOffset;k.chromHeight=e.offsetHeight;k.offsetHeight=e.offsetHeight+2*this._sliderOffset;f.dragCoord="base";d&&(d.adjustToContainer?(g=jQuery(this.container)[0],e=I("top",e,g),k.offsetTop=e,k.offsetHeight=g.offsetHeight):d.offset&&(k.offsetTop=d.offset,k.offsetHeight=e.offsetHeight+2*d.offset),
d.coord&&h.test(d.coord)&&(e=this.getRep(),g=L(d.coord),e="function"==typeof e[g]?(e=e[g]())?e.name:null:null,e?f.dragCoord=e:console.error("IDEO: coordinate "+d.coord+" is not valid for selected representation")),"function"==typeof d.onStyleSet&&(k.styleCallback=d.onStyleSet));this.setRegionRange(b,c)}else console.error("Cannot select region on chromosome '"+b+"' - chromosome is not present")}};IDEO.Ideogram.prototype.clearSelection=function(a){for(var b=0;b<a.length;b++)this._clearSelection(a[b])};
IDEO.Ideogram.prototype._clearSelection=function(a){a=this.selectorForElement("chrom",a);a=jQuery(a)[0];if(a=jQuery(".slider",a)[0])jQuery(a).css({display:"none","margin-left":0,"margin-right":0}),jQuery(a).unbind("mousedown",c)}})();(function(){function a(a,b){for(var c=0;c<a.length;c++){var d=a[c],e=d.chrom,g=d.index;b[e]?b[e][g]||(b[e][g]=[]):(b[e]={},b[e][g]=[]);b[e][g].push(d)}}function c(a){var b=function(a,b){return a.range.x-b.range.x},c;for(c in a)for(var d in a[c]){var e=a[c][d];e.sort(b);
for(D=e.length-1;0<D--;)e[D].range.x+e[D].range.width>=e[D+1].range.x&&(e[D].range.width=e[D+1].range.x+e[D+1].range.width-e[D].range.x,e.splice(D+1,1))}}function b(a,b,c){var d=this._highlightId;if(c||null==c){c=m[d]||[];for(var e=0;e<c.length;e++){var g=c[e];g.parentNode&&g.parentNode.removeChild(g);l.push(g)}}a=a||v[d]||{};for(var h in a)for(var q in a[h])if(c=a[h][q],0<c.length)try{for(var k=-this.padding[c[0].type]||0,e=0;e<c.length;e++){var n=this.highlightCls,p=l.pop();p||(p=document.createElement("a"),
p.className=n||"highlight",p.ideoElement="parentNode");p.innerHTML="";g=p;k+=f.apply(this,[g,c[e],k,b]);m[d].push(g)}}catch(W){console.error(W)}}function d(a){var b=a.chrom;null==b&&a.bandStart&&(b=r.exec(a.bandStart)[1]);return b}function f(a,b,c,d){var e=this.selectorForElement(b.type,b.chrom)+" .ideo-hlt-wrap",g=Math.max(0,b.index),g=jQuery(e)[g];g.appendChild(a);var f=ba(a),e=b.range.width;this.isVertical()?(c={top:String(b.range.x-c-f.top)+"px",left:String(-f.left)+"px",height:String(e)+"px",
width:String(g.offsetWidth)+"px"},f=f.top+f.bottom,g={el:a,width:g.offsetWidth,height:e}):(c={left:String(b.range.x-c-f.left)+"px",top:String(-f.top)+"px",width:String(e)+"px",height:String(g.offsetHeight)+"px"},f=f.left+f.right,g={el:a,width:e,height:g.offsetHeight});jQuery(a).css(c);if("function"==typeof d)try{d.call(this,b,g)}catch(t){console.error(t)}return e+f}function h(a){for(var b=0;b<a.length;b++){var c=a[b],d=c.range=e.apply(this,[c.data]);c.offset=d.x+d.width/2}}function e(a){return null!=
a._off?{x:a._off,width:a._width}:g.apply(this,[a])}function g(a){var b=a?d(a):null;if(a&&b){var c=this.getRep(),e=this._chromMap[b]||{};if(!e.size)return null;if(null!=a.start&&null!=a.stop){if(isNaN(a.start)||isNaN(a.stop))return console.error("RegionRange: start and stop must be numbers"),null;var g=c.getBase(),f=c.getAux();if("iscn"!=g.type){c=e.size[g.chrStart];e=e.size[g.chrStop];if(a.start>=e||a.stop<=c)return null;a.start<c&&(a.start=c);a.stop>e&&(a.stop=e);e=this.offsetForBaseCoord(b,a.start);
return{x:e,width:this.offsetForBaseCoord(b,a.stop)-e}}if(null!=f){c=e.size[f.chrStart];e=e.size[f.chrStop];if(a.start>=e||a.stop<=c)return null;a.start<c&&(a.start=c);a.stop>e&&(a.stop=e);e=this.offsetForAuxCoord(b,a.start);return{x:e,width:this.offsetForAuxCoord(b,a.stop)-e}}console.error("RegionRange: numeric region type is not supported - only cyto coord is available in representation")}else if(null!=a.bandStart){g={};if(this.getBandRegion(b,a.bandStart,g,!1)){e=g.base.start;g=g.base.stop;c={};
if(a.bandStop&&this.getBandRegion(b,a.bandStop,c,!0))e=Math.min(e,c.base.start),g=Math.max(g,c.base.stop);else if(a.bandStop)return console.error("RegionRange: Invalid stop band in region specification"),null;e=this.offsetForBaseCoord(b,e);return{x:e,width:this.offsetForBaseCoord(b,g)-e}}console.error("RegionRange: Invalid band(s) in region specification")}else console.error("RegionRange: invalid range")}return null}var k=0,l=[],m={},v={};IDEO.Ideogram.prototype.highlightAnnotations=function(d,e,
g){IDEO.assert(this.isReady(),"Ideogram is not ready");var f=this._highlightId=this._highlightId||++k;m[f]||(m[f]=[]);v[f]||(v[f]={});f=v[f];d=this.findAnnotations(d);h.apply(this,[d]);a(d,f);c(f);b.call(this,f,e,g);return d};IDEO.Ideogram.prototype.clearHighlights=function(){var a=this._highlightId;if(null!=a){for(var b=m[a]||[],c=0;c<b.length;c++){var d=b[c];d.parentNode&&d.parentNode.removeChild(d);l.push(d)}delete m[a];delete v[a]}};IDEO.Ideogram.prototype.findAnnotations=function(a){this._highlightId=
this._highlightId||++k;for(var b=[],c=this.getAnnotations(),e=0;e<c.length;e++){var g=c[e].getData()||[],f=c[e].getType();c[e].isTrack();for(var h=0;h<g.length;h++){var m;a:{m=a;var l=g[h],q=void 0;for(q in m)if(!m.hasOwnProperty(q)||m[q]!=l[q]){m=!1;break a}m=!0}m&&(m={data:g[h],index:c[e].getTrackIndex(),type:f,ideoId:this._highlightId,chrom:d(g[h])},b.push(m))}}return b};IDEO.Ideogram.prototype.highlightRegions=function(a,g,f){IDEO.assert(this.isReady(),"Ideogram is not ready");var h=this._highlightId=
this._highlightId||++k;m[h]=m[h]||[];if(a){for(var h={},l=!1,q=0;q<a.length;q++){var n=e.apply(this,[a[q]]);if(null!=n){var p=d(a[q]),n={data:a[q],ideoId:this._highlightId,index:-1,range:n,type:"chrom",chrom:p};h[p]=h[p]||{};(h[p][-1]=h[p][-1]||[]).push(n)}else l||(l=!0,console.error("*** invalid region(s)"))}c(h);b.call(this,h,g,f)}};IDEO.Ideogram.prototype.highlightFeats=function(c,e,g,f){IDEO.assert(null!=c&&"function"==typeof c.getTrackIndex,"highlightFeats: annot argument must be an annotation");
IDEO.assert(this.isReady(),"Ideogram is not ready");var l=this._highlightId=this._highlightId||++k;m[l]=m[l]||[];var l=v[l]=v[l]||{},q=[],n=c.getTrackIndex();c=c.getType();for(var p=0;p<e.length;p++){var r={data:e[p],index:n,type:c,ideoId:this._highlightId,chrom:d(e[p])};q.push(r)}h.apply(this,[q]);a(q,l);b.call(this,l,g,f);return q};var r=/^([^pq]*)([pq])(.*)/;IDEO.Ideogram.prototype.getRectForRegion=function(a){var b=g.apply(this,[a]);return b?(a=d(a),a=jQuery(this.container+" [chrom="+a+"] .ideo-chrom")[0].getBoundingClientRect(),
a={x:a.left,y:a.top,width:a.right-a.left,height:a.bottom-a.top},this.isVertical()?(a.y+=b.x,a.height=b.width):(a.x+=b.x,a.width=b.width),a):null}})();(function(){IDEO.BandLabelConfig=function(a){this._id=++IDEO._ideoid;if(a)if("string"===typeof a)this.setMode(a);else for(var b in a){var c=aa(b);jQuery.isFunction(this[c])?this[c].call(this,a[b]):console.error('Invalid property in BandLabelConfig: "'+b+'"')}};var a=/^along$|^across$/;IDEO.BandLabelConfig.prototype={setMode:function(c){IDEO.assert(c&&
c.match(a),'BandLabelConfig: invalid mode: "'+c+'"');this._mode=c},setWidth:function(a){IDEO.assert(!isNaN(a)&&0<a,'BandLabelConfig: invalid width: "'+a+'"');this._width=a},setNumRows:function(a){IDEO.assert(!isNaN(a)&&0<a,'BandLabelConfig: invalid numRows: "'+a+'"');this._numRows=a},setColor:function(a){this._color=a},setLineColor:function(a){this._lineColor=a},setDotColor:function(a){this._dotColor=a},setIncludeArm:function(a){this._includeArm=a?!0:!1},setIncludeChrom:function(a){this._includeChrom=
a?!0:!1},setMargin:function(a){IDEO.assert(!isNaN(a)&&0<a,"BandLabelConfig: invalid margin value: "+a);this._margin=a},setFontFace:function(a){console.warn("BandLabelConfig: fontFace option is ignored, use fontFace option in Ideogram config")},setFontSize:function(a){this._fontSize=a},setRowMargin:function(a){this._rowMargin=a},setOffset:function(a){this._offset=a},setAlign:function(a){IDEO.assert(a==IDEO.TextAlign.Left||a==IDEO.TextAlign.Right,'BandLabelConfig: invalid "align" value: "'+a+'"');this._align=
a==IDEO.TextAlign.Left?0:1},setReverse:function(a){this._reverse=a?!0:!1},setCondensed:function(a){this._condensed=a?!0:!1},setFlipped:function(a){this._flipped=a?!0:!1},isFlipped:function(){return this._flipped},encode:function(a){a=(this._includeArm?1:0)|(this._includeChrom?3:0)|this._align<<2|(this._reverse?16:0)|(this._condensed?32:0)|(this._flipped?64:0);var b=function(a,b){return jQuery.map(a,function(a,b){return jQuery.isArray(a)?a:null!=a?String(a):""}).join(b)};return b([this._mode,this._numRows,
this._width,b([this._color,this._lineColor,this._dotColor],","),b([this._margin,this._rowMargin,this._offset],","),b([this._fontFace,this._fontSize],","),a],"|")},toString:function(){return"[object BandLabelConfig:"+this._id+"]"},_includeArm:!0,_includeChrom:!1,_color:"#000000",_align:0,_flipped:!1}})();(function(){function a(a){this.panel=document.createElement("div");this.panel.innerHTML="<div class='download-content'><div class='section'><span class='header'>Format:</span><span class='download-fmt'><select><option value='svg'>SVG</option><option value='eps'>EPS</option><option value='png'>PNG</option><option value='jpg'>JPEG</option><option value='tiff'>TIFF</option><option value='pdf'>PDF</option></select></span></div><div class='section'><span class='header'>File name:</span><input type='text'class='download-file' value='Ideogram'/><span class='file-ext'>.svg</span></div><div class='section download-layout'><span class='header'>Rows:</span><input value='1'/><span class='header2'>Columns:</span></span><input value='1'/></div><div class='section download-size'><span class='header'>Size (W x H):</span><span class='width'><input type='text'/></span>x<span class='height'><input type='text'/></span>(px)</div><div class='section buttons'><button>Download</button><button>Cancel</button></div></div>";
this.panel.className="ideo-download-panel";document.body.appendChild(this.panel);var b=this;b.file="Ideogram";b.fmt="png";b.setConfig(a);jQuery(".section.buttons button").each(function(a,b){b.tag=a}).bind("click",function(a){switch(a.currentTarget.tag){case 0:b.download();break;case 1:b.cancelDownload()}});jQuery(".download-fmt select",b.panel).each(function(a,c){jQuery(".file-ext",b.panel).text("."+c.value)}).bind("change",function(a){jQuery(".file-ext",b.panel).text("."+a.currentTarget.value);b.isVector(a.currentTarget.value)?
jQuery(b.panel).addClass("ideo-nosize"):jQuery(b.panel).removeClass("ideo-nosize")});b.imageSize=jQuery(".download-size input",b.panel);b.imageSize.each(function(a,b){b.tag=a}).bind("keydown",function(a){a=a.which;return 48<=a&&57>=a||96<=a&&105>=a||37<=a&&40>=a||8==a||9==a||46==a}).bind("keyup",function(a){var c=a.target;a=a.which;if(9==a||37<=a&&40>=a)return!0;96<=a&&(a-=48);if(48<=a&&57>=a||8==a||46==a){if(b.cfg.constrainSize&&b.size)switch(a=parseInt(c.value),c.tag){case 0:b.imageSize[1].value=
isNaN(a)?"":Math.round(b.size.height/b.size.width*a);break;case 1:b.imageSize[0].value=isNaN(a)?"":Math.round(b.size.width/b.size.height*a)}return!0}return!1});b.content=jQuery(".download-content",b.panel)[0];jQuery(b.content).bind("mousedown",{self:b},c)}function c(a){if(f[a.target.nodeName])return!0;var c=getComputedStyle(a.data.self.content),d=parseInt(c.getPropertyValue("left")),c=parseInt(c.getPropertyValue("top"));a={self:a.data.self,x:a.clientX,y:a.clientY,loc:{x:isNaN(d)?0:d,y:isNaN(c)?0:
c}};jQuery(document).bind("mousemove",{info:a,finish:!1},b);jQuery(document).bind("mouseup",{info:a,finish:!0},b);return!1}function b(a){var c=a.data.info,d=a.clientX,f=a.clientY;jQuery(c.self.content).css({top:String(c.loc.y+f-c.y)+"px",left:String(c.loc.x+d-c.x)+"px"});a.data.finish&&(jQuery(document).unbind("mousemove",b),jQuery(document).unbind("mouseup",b));return!1}var d;a.prototype={setIdeogram:function(a){this.ideo=a;this.update()},update:function(){if(null!=this.ideo){var a=this,b=a.ideo.getImageSize();
jQuery(".download-size input",a.panel).each(function(a,c){switch(a){case 0:c.value=b.width;break;case 1:c.value=b.height}});jQuery(".download-layout input",a.panel).each(function(b,c){switch(b){case 0:c.value=a.ideo.numrows;break;case 1:c.value=a.ideo.numcols}});a.size={width:Math.ceil(b.width),height:Math.ceil(b.height)};jQuery(".download-fmt select",a.panel)[0].value=a.fmt;jQuery(".download-file",a.panel)[0].value=a.file;jQuery(".file-ext",a.panel).text("."+a.fmt)}},setConfig:function(a){this.cfg=
{};a&&(jQuery.extend(this.cfg,a),a.constrainSize&&a.allowLayout&&(console.error("'constrainSize' and 'allowLayout' cannot be specified together"),this.cfg.constrainSize=!1));jQuery(".download-size",this.panel).toggleClass("ideo-hidden",!this.cfg.showSize);jQuery(".download-layout",this.panel).toggleClass("ideo-hidden",!this.cfg.allowLayout)},display:function(){if(this.ideo){jQuery(this.panel).css({display:"block"});var a=jQuery(".download-content",this.panel)[0],b=Math.floor(.33*(this.panel.offsetHeight-
a.offsetHeight));jQuery(a).css({"margin-top":String(b)+"px"})}},cancelDownload:function(){this.update();this.close()},download:function(){var a=this;if(a.ideo){var b={embedFont:1};b.fmt=a.fmt=jQuery(".download-fmt select",a.panel)[0].value;b.file=a.file=jQuery(".download-file",a.panel)[0].value;a.cfg.allowLayout&&jQuery(".download-layout input",a.panel).each(function(a,c){switch(a){case 0:b.numrows=Math.max(1,parseInt(c.value));break;case 1:b.numcols=Math.max(1,parseInt(c.value))}});if(a.cfg.showSize&&
!a.isVector(b.fmt)){var c,d;jQuery(".download-size input",a.panel).each(function(a,b){switch(a){case 0:c=parseInt(b.value);break;case 1:d=parseInt(b.value)}});if(c!=a.size.width||d!=a.size.height)b.size={width:c,height:d}}a.cfg.cb&&(b.cb=a.cfg.cb);a.ideo.download(b);setTimeout(function(){a.close()},500)}else alert("Ideogram is not set")},close:function(){jQuery(this.panel).css({display:""})},isVector:function(a){for(var b=0;b<this.vt.length;b++)if(a==this.vt[b])return!0;return!1},vt:["svg","eps",
"pdf"]};var f={SELECT:!0,INPUT:!0,BUTTON:!0,OPTION:!0};IDEO.getDownloadPanel=function(b){d||(d=new a(b));return d}})();(function(){function a(a,b){IDEO.assert(null!=a,"ErrorLog: log container selector is required");this._sel=a;b&&this.setCallback(b);var c=this;jQuery(document).ready(function(){c.init()})}function c(){if(this.panel){this.$panel.addClass("ideo-hidden");this.$header.text("");for(var a=this.$table[0],b=a.rows.length;0<b--;)a.deleteRow(b)}else console.error("ErrorLog: not allowed - document is not ready")}
function b(a,b,c,f){c={};a=a.getAllAnnotations();for(var e=0;e<b.length;e++){var g=b[e],h=null!=g.index?g.index:IDEO.ErrorIndex.Renderer,k=null!=g.chrom?g.chrom:"";c[h]=c[h]||{};c[h][k]=c[h][k]||[];c[h][k].push(g)}this.$panel.removeClass("ideo-hidden");b=this.$table[0];for(h in c)for(k in h=parseInt(h),c[h]){var g=b.rows.length,l=c[h][k],e=a[h],p;e?p=e.getName():f&&(p=f[h]);if(null==p)switch(h){case IDEO.ErrorIndex.Annotations:p="Annotation";break;case IDEO.ErrorIndex.Ideogram:p="Ideogram";break;
case IDEO.ErrorIndex.Data:p="Ideogram data";break;case IDEO.ErrorIndex.Service:p="Ideogram service";break;case IDEO.ErrorIndex.Netcache:p="NetCache";break;case IDEO.ErrorIndex.Legend:p="Legend";break;case IDEO.ErrorIndex.Renderer:p="Renderer";break;case IDEO.ErrorIndex.Server:p="Server";break;case IDEO.ErrorIndex.JavaScript:p="JavaScript";break;default:p="Unknown error source"}e=b.insertRow(-1);e.className="ideo-error-group";var u=e.insertCell(-1);u.innerHTML=p+(k?" - chrom: "+k:"");u.setAttribute("colspan",
3);e.groupId=g;for(e=0;e<l.length;e++)d.call(this,l[e],b,e,g)}this.$header.text(b.rows[0].cells[0].innerHTML);d.call(this,null,b,0,null)}function d(a,b,c,d){b=b.insertRow(-1);if(a){if(this._callback&&(a=this._callback(a)),a){var e=b.insertCell(-1);switch(a.severity){case IDEO.ErrorCode.warning:e.innerHTML="Warning";b.className="ideo-log-warning";break;case IDEO.ErrorCode.error:e.innerHTML="Error";b.className="ideo-log-error";break;case IDEO.ErrorCode.failed:e.innerHTML="Failure";b.className="ideo-log-failed";
break;default:e.innerHTML="I",b.className="ideo-log-info"}e.className="ideo-log-severity";e=b.insertCell(-1);e.innerHTML=a.name;e.className="ideo-log-name";e=b.insertCell(-1);e.innerHTML=a.description;e.className="ideo-log-desc";c%2&&jQuery(b).addClass("ideo-log-odd")}}else e=b.insertCell(-1),e.innerHTML="&#x00A0;",e.setAttribute("colspan",3);b.groupId=d}function f(a){var b=a.data.self;a=b.$table[0];for(var c=a.rows,d=0,e=c.length,f=b.tableOffset+b.$body.scrollTop();d<e;){var r=Math.floor((d+e)/2);
f<c[r].offsetTop?e=r:d=r+1}for(r=e+1;0<r--;)if(c[r].offsetTop<=f){b.groupId!=c[r].groupId&&(b.groupId=c[r].groupId,b.$header.text(a.rows[c[r].groupId].cells[0].innerHTML));break}h&&clearTimeout(h);h=setTimeout(function(){var a=c[r].offsetTop-b.tableOffset;c[r].groupId==r?a+=c[r].offsetHeight+1:0<r&&c[r-1].groupId==r-1&&(a+=1);a!=b.$body.scrollTop()&&b.$body.scrollTop(a);h=null},450)}a.prototype={init:function(){this.$container=jQuery(this._sel);IDEO.assert(1==this.$container.length,'ErrorLog: invalid log container selector "'+
this._sel+'"');this.panel=document.createElement("div");this.$panel=jQuery(this.panel);this.$container[0].appendChild(this.panel);this.$panel.addClass("ideo-error-log").addClass("ideo-hidden");this.panel.innerHTML="<div class='ideo-error-header'></div><div class='ideo-error-body'><table></table></div>";this.$header=jQuery(".ideo-error-header",this.panel);this.$body=jQuery(".ideo-error-body",this.panel);this.$table=jQuery("table",this.$body);this.$body.bind("scroll",{self:this},f);this.tableOffset=
-parseInt(getComputedStyle(this.$table[0]).getPropertyValue("margin-top"))},clearErrors:c,clear:c,showErrors:function(a,d,f,h){if(this.panel){if(f||c.apply(this),a&&d&&0<d.length)try{b.apply(this,arguments)}catch(m){console.error(m)}}else console.error("ErrorLog: not allowed - document is not ready")},setCallback:function(a){console.assert(null==a||"function"==typeof a,"IDEO.ErrorLog: callback must be function or null");a?this._callback=a:delete this._callback}};var h;IDEO.ErrorLog=a})();jQuery.parseJSON=
function(a){if("string"!==typeof a||!a)return null;a=jQuery.trim(a);return window.JSON&&window.JSON.parse?window.JSON.parse(a):(new Function("return "+a))()}})(jQuery);
